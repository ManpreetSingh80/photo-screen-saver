<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"background_alarm.js.html":{"id":"background_alarm.js.html","title":"Source: background/alarm.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: background/alarm.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Manage alarms from the chrome.alarms API * @see https://developer.chrome.com/apps/alarms * @namespace */ app.Alarm = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); /** * Alarms triggered by chrome.alarms * @typedef {Object} Alarms * @property {string} ACTIVATE - screen saver is active * @property {string} DEACTIVATE - screen saver is not activate * @property {string} UPDATE_PHOTOS - photo sources should be updated * @property {string} BADGE_TEXT - icon's Badge text should be set * @const * @private * @memberOf app.Alarm */ const _ALARMS = { 'ACTIVATE': 'ACTIVATE', 'DEACTIVATE': 'DEACTIVATE', 'UPDATE_PHOTOS': 'UPDATE_PHOTOS', 'BADGE_TEXT': 'BADGE_TEXT', }; /** * Set state when the screensaver is in the active time range * @private * @memberOf app.Alarm */ function _setActiveState() { if (app.Storage.getBool('keepAwake')) { chrome.power.requestKeepAwake('display'); } const interval = app.Data.getIdleSeconds(); chromep.idle.queryState(interval).then((state) =&gt; { // display screensaver if enabled and the idle time criteria is met if (app.Storage.getBool('enabled') &amp;&amp; (state === 'idle')) { app.SSControl.display(false); } return Promise.resolve(); }).catch((err) =&gt; { app.GA.error(err.message, 'Alarm._setActiveState'); }); app.Alarm.updateBadgeText(); } /** * Set state when the screensaver is in the inactive time range * @private * @memberOf app.Alarm */ function _setInactiveState() { if (app.Storage.getBool('allowSuspend')) { chrome.power.releaseKeepAwake(); } else { chrome.power.requestKeepAwake('system'); } app.SSControl.close(); app.Alarm.updateBadgeText(); } /** * Set the Badge text on the icon * @private * @memberOf app.Alarm */ function _setBadgeText() { let text = ''; if (app.Storage.getBool('enabled')) { text = app.Alarm.isActive() ? '' : app.Utils.localize('sleep_abbrev'); } else { text = app.Storage.getBool('keepAwake') ? app.Utils.localize('power_abbrev') : app.Utils.localize('off_abbrev'); } chrome.browserAction.setBadgeText({text: text}); } /** * Event: Fired when an alarm has elapsed. * @see https://developer.chrome.com/apps/alarms#event-onAlarm * @param {Object} alarm - details on alarm * @private * @memberOf app.Alarm */ function _onAlarm(alarm) { switch (alarm.name) { case _ALARMS.ACTIVATE: // entering active time range of keep awake _setActiveState(); break; case _ALARMS.DEACTIVATE: // leaving active time range of keep awake _setInactiveState(); break; case _ALARMS.UPDATE_PHOTOS: // get the latest for the live photo streams app.PhotoSource.processDaily(); break; case _ALARMS.BADGE_TEXT: // set the icons text _setBadgeText(); break; default: break; } } // Listen for alarms chrome.alarms.onAlarm.addListener(_onAlarm); return { /** * Set the repeating alarms states * @memberOf app.Alarm */ updateRepeatingAlarms: function() { const keepAwake = app.Storage.getBool('keepAwake'); const aStart = app.Storage.getBool('activeStart'); const aStop = app.Storage.getBool('activeStop'); // create keep awake active period scheduling alarms if (keepAwake &amp;&amp; (aStart !== aStop)) { const startDelayMin = app.Time.getTimeDelta(aStart); const stopDelayMin = app.Time.getTimeDelta(aStop); chrome.alarms.create(_ALARMS.ACTIVATE, { delayInMinutes: startDelayMin, periodInMinutes: app.Time.MIN_IN_DAY, }); chrome.alarms.create(_ALARMS.DEACTIVATE, { delayInMinutes: stopDelayMin, periodInMinutes: app.Time.MIN_IN_DAY, }); // if we are currently outside of the active range // then set inactive state if (!app.Time.isInRange(aStart, aStop)) { _setInactiveState(); } } else { chrome.alarms.clear(_ALARMS.ACTIVATE); chrome.alarms.clear(_ALARMS.DEACTIVATE); } // Add daily alarm to update photo sources that request this chromep.alarms.get(_ALARMS.UPDATE_PHOTOS).then((alarm) =&gt; { if (!alarm) { chrome.alarms.create(_ALARMS.UPDATE_PHOTOS, { when: Date.now() + app.Time.MSEC_IN_DAY, periodInMinutes: app.Time.MIN_IN_DAY, }); } return Promise.resolve(); }).catch((err) =&gt; { app.GA.error(err.message, 'chromep.alarms.get(_ALARMS.UPDATE_PHOTOS)'); }); }, /** * Set the icon badge text * @memberOf app.Alarm */ updateBadgeText: function() { // delay setting a little to make sure range check is good chrome.alarms.create(_ALARMS.BADGE_TEXT, { when: Date.now() + 250, }); }, /** * Determine if the screen saver can be displayed * @returns {boolean} true, if can display * @memberOf app.Alarm */ isActive: function() { const enabled = app.Storage.getBool('enabled'); const keepAwake = app.Storage.getBool('keepAwake'); const aStart = app.Storage.get('activeStart'); const aStop = app.Storage.get('activeStop'); const inRange = app.Time.isInRange(aStart, aStop); // do not display if screen saver is not enabled or // keepAwake scheduler is enabled and is in the inactive range return !(!enabled || (keepAwake &amp;&amp; !inRange)); }, }; })(); Ã— Search results Close "},"background_background.js.html":{"id":"background_background.js.html","title":"Source: background/background.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: background/background.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ (function() { 'use strict'; /** * The background script for the extension.&lt;br&gt; * @namespace app.Background */ new ExceptionHandler(); /** * Display the options tab * @private * @memberOf app.Background */ function _showOptionsTab() { // send message to the option tab to focus it. app.Msg.send(app.Msg.HIGHLIGHT).catch(() =&gt; { // no one listening, create it chrome.tabs.create({url: '../html/options.html'}); }); } /** * Toggle enabled state of the screen saver * @private * @memberOf app.Background */ function _toggleEnabled() { app.Storage.set('enabled', !app.Storage.getBool('enabled')); // storage changed event not fired on same page as the change app.Data.processState('enabled'); } /** * Event: Fired when the extension is first installed,&lt;br /&gt; * when the extension is updated to a new version,&lt;br /&gt; * and when Chrome is updated to a new version. * @see https://developer.chrome.com/extensions/runtime#event-onInstalled * @param {Object} details - type of event * @private * @memberOf app.Background */ function _onInstalled(details) { const chromep = new ChromePromise(); // create menus on the right click menu of the extension icon chromep.contextMenus.create({ type: 'normal', id: 'ENABLE_MENU', title: app.Utils.localize('disable'), contexts: ['browser_action'], }).catch((err) =&gt; { if (!err.message.includes('duplicate id')) { app.GA.error(err.message, 'chromep.contextMenus.create'); } }); chromep.contextMenus.create({ type: 'separator', id: 'SEP_MENU', contexts: ['browser_action'], }).catch((err) =&gt; { if (!err.message.includes('duplicate id')) { app.GA.error(err.message, 'chromep.contextMenus.create'); } }); if (details.reason === 'install') { app.GA.event(app.GA.EVENT.INSTALLED); app.Data.initialize(); _showOptionsTab(); } else if (details.reason === 'update') { // extension updated app.Data.update(); } } /** * Event: Fired when a profile that has this extension installed first * starts up * @see https://developer.chrome.com/extensions/runtime#event-onStartup * @private * @memberOf app.Background */ function _onStartup() { app.GA.page('/background.html'); app.Data.processState(); } /** * Event: Fired when a browser action icon is clicked. * @see https://goo.gl/abVwKu * @private * @memberOf app.Background */ function _onIconClicked() { _showOptionsTab(); } /** * Event: Fired when item in localStorage changes * @see https://developer.mozilla.org/en-US/docs/Web/Events/storage * @param {Event} event - StorageEvent * @param {string} event.key - storage item that changed * @private * @memberOf app.Background */ function _onStorageChanged(event) { app.Data.processState(event.key); } /** * Event: Fired when a context menu item is clicked. * @see https://developer.chrome.com/extensions/contextMenus#event-onClicked * @param {Object} info - info. on the clicked menu * @param {Object} info.menuItemId - menu name * @private * @memberOf app.Background */ function _onMenuClicked(info) { if (info.menuItemId === 'ENABLE_MENU') { const isEnabled = app.Storage.get('enabled'); app.GA.event(app.GA.EVENT.MENU, `${info.menuItemId}: ${isEnabled}`); _toggleEnabled(); } } /** * Event: Fired when a registered command is activated using * a keyboard shortcut. * @see https://developer.chrome.com/extensions/commands#event-onCommand * @param {string} cmd - keyboard command * @private * @memberOf app.Background */ function _onKeyCommand(cmd) { if (cmd === 'toggle-enabled') { _toggleEnabled(); } } // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {app.Msg.Message} request - details for the message * @param {Object} [sender] - MessageSender object * @param {Function} [response] - function to call once after processing * @returns {boolean} true if asynchronous * @private * @memberOf app.Background */ function _onChromeMessage(request, sender, response) { if (request.message === app.Msg.RESTORE_DEFAULTS.message) { app.Data.restoreDefaults(); } else if (request.message === app.Msg.STORE.message) { app.Storage.set(request.key, request.value); } return false; } // listen for extension install or update chrome.runtime.onInstalled.addListener(_onInstalled); // listen for Chrome starting chrome.runtime.onStartup.addListener(_onStartup); // listen for click on the icon chrome.browserAction.onClicked.addListener(_onIconClicked); // listen for changes to the stored data addEventListener('storage', _onStorageChanged, false); // listen for chrome messages app.Msg.listen(_onChromeMessage); // listen for clicks on context menus chrome.contextMenus.onClicked.addListener(_onMenuClicked); // listen for special keyboard commands chrome.commands.onCommand.addListener(_onKeyCommand); })(); Ã— Search results Close "},"background_chromecast.js.html":{"id":"background_chromecast.js.html","title":"Source: background/chromecast.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: background/chromecast.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Interface to the Chromecast photos * @namespace */ app.ChromeCast = (function() { 'use strict'; new ExceptionHandler(); return { /** * Get the photos from chromecast.json * @returns {Promise&lt;app.PhotoSource.SourcePhoto[]&gt;} Array of photos * @memberOf app.ChromeCast */ loadPhotos: function() { const url = '/assets/chromecast.json'; return app.Http.doGet(url).then((photos) =&gt; { photos = photos || []; photos.forEach((photo) =&gt; { photo.asp = 16 / 9; }); return Promise.resolve(photos); }); }, }; })(); Ã— Search results Close "},"background_data.js.html":{"id":"background_data.js.html","title":"Source: background/data.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: background/data.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Manage the extensions data * @namespace */ app.Data = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); /** * Version of localStorage - update when items are added, removed, changed * @type {int} * @default * @const * @private * @memberOf app.Data */ const _DATA_VERSION = 12; /** * A number and associated units * @typedef {Object} UnitValue * @property {number} base - value in base unit * @property {number} display - value in display unit * @property {int} unit - display unit */ /** * Values for items in localStorage * @typedef {Object} AppData * @property {int} version - version of data * @property {boolean} enabled - is screensaver enabled * @property {string} permPicasa - optional permission for Picasa * @property {UnitValue} idleTime - idle time to display screensaver * @property {UnitValue} transitionTime - time between photos * @property {boolean} skip - ignore extreme aspect ratio photos * @property {boolean} shuffle - randomize photo order * @property {int} photoSizing - photo display type * @property {int} photoTransition - transition animation * @property {int} showTime - time display format * @property {boolean} largeTime - display larger time label * @property {boolean} showPhotog - display name on own photos * @property {boolean} showLocation - display photo location * @property {string} background - background image * @property {boolean} keepAwake - manage computer poser settings * @property {boolean} chromeFullscreen - don't display over fullscreen * @property {boolean} allDisplays - show on all displays * @property {string} activeStart - Keep Wake start time '00:00' 24 hr * @property {string} activeStop - Keep Wake stop time '00:00' 24 hr * @property {boolean} allowSuspend - let computer sleep * @property {boolean} useSpaceReddit - use this photo source * @property {boolean} useEarthReddit - use this photo source * @property {boolean} useAnimalReddit - use this photo source * @property {boolean} useEditors500px - use this photo source * @property {boolean} usePopular500px - use this photo source * @property {boolean} useYesterday500px - use this photo source * @property {boolean} useInterestingFlickr - use this photo source * @property {boolean} useChromecast - use this photo source * @property {boolean} useAuthors - use this photo source * @property {boolean} useGoogle - use this photo source * @property {boolean} useSpaceReddit - use this photo source * @property {Array} albumSelections - Users Google Photos to use */ /** * Default values in localStorage * @type {AppData} * @const * @private * @memberOf app.Data */ const _DEF_VALUES = { 'version': _DATA_VERSION, 'enabled': true, 'permPicasa': 'notSet', // enum: notSet allowed denied 'idleTime': {'base': 5, 'display': 5, 'unit': 0}, // minutes 'transitionTime': {'base': 30, 'display': 30, 'unit': 0}, // seconds 'skip': true, 'shuffle': true, 'photoSizing': 0, 'photoTransition': 4, 'showTime': 2, // 24 hr format 'largeTime': false, 'showPhotog': true, 'showLocation': true, 'background': 'background:linear-gradient(to bottom, #3a3a3a, #b5bdc8)', 'keepAwake': false, 'chromeFullscreen': true, 'allDisplays': false, 'activeStart': '00:00', // 24 hr time 'activeStop': '00:00', // 24 hr time 'allowSuspend': false, 'useSpaceReddit': false, 'useEarthReddit': false, 'useAnimalReddit': false, 'useEditors500px': false, 'usePopular500px': false, 'useYesterday500px': false, 'useInterestingFlickr': false, 'useChromecast': true, 'useAuthors': false, 'useGoogle': true, 'albumSelections': [], }; /** * Set state based on screensaver enabled flag * Note: this does not effect the keep awake settings so you could * use the extension as a display keep awake scheduler without * using the screensaver * @private * @memberOf app.Data */ function _processEnabled() { // update context menu text const label = app.Storage.getBool('enabled') ? app.Utils.localize('disable') : app.Utils.localize('enable'); app.Alarm.updateBadgeText(); chromep.contextMenus.update('ENABLE_MENU', { title: label, }).catch(() =&gt; {}); } /** * Set power scheduling features * @private * @memberOf app.Data */ function _processKeepAwake() { app.Storage.getBool('keepAwake') ? chrome.power.requestKeepAwake('display') : chrome.power.releaseKeepAwake(); app.Alarm.updateRepeatingAlarms(); app.Alarm.updateBadgeText(); } /** * Set wait time for screen saver display after machine is idle * @private * @memberOf app.Data */ function _processIdleTime() { chrome.idle.setDetectionInterval(app.Data.getIdleSeconds()); } /** * Get default time format based on locale * @returns {int} 12 or 24 * @private * @memberOf app.Data */ function _getTimeFormat() { let ret = 2; // 24 hr const format = app.Utils.localize('time_format'); if (format &amp;&amp; (format === '12')) { ret = 1; } return ret; } /** * Set the 'os' value * @returns {Promise} err on failure * @private * @memberOf app.Data */ function _setOS() { return chromep.runtime.getPlatformInfo().then((info) =&gt; { app.Storage.set('os', info.os); return Promise.resolve(); }); } /** * Save the [_DEF_VALUES]{@link app.Data._DEF_VALUES} items, if they * do not already exist * @private * @memberOf app.Data */ function _addDefaults() { Object.keys(_DEF_VALUES).forEach(function(key) { if (app.Storage.get(key) === null) { app.Storage.set(key, _DEF_VALUES[key]); } }); } /** * Convert a setting-slider value due to addition of units * @param {!string} key - localStorage key * @private * @memberOf app.Data */ function _convertSliderValue(key) { const value = app.Storage.get(key); if (value) { const newValue = { base: value, display: value, unit: 0, }; app.Storage.set(key, newValue); } } return { /** * Initialize the data saved in localStorage * @memberOf app.Data */ initialize: function() { _addDefaults(); // set operating system _setOS().catch(() =&gt; {}); // set time format based on locale app.Storage.set('showTime', _getTimeFormat()); // update state app.Data.processState(); }, /** * Update the data saved in localStorage * @memberOf app.Data */ update: function() { // New items, changes, and removal of unused items can take place // here when the version changes const oldVersion = app.Storage.getInt('version'); if (_DATA_VERSION &gt; oldVersion) { // update version number app.Storage.set('version', _DATA_VERSION); } if (oldVersion &lt; 12) { // picasa used to be a required permission // installed extensions before the change will keep // this permission on update. // https://stackoverflow.com/a/38278824/4468645 app.Storage.set('permPicasa', 'allowed'); } if (oldVersion &lt; 10) { // was setting this without quotes before const oldOS = localStorage.getItem('os'); if (oldOS) { app.Storage.set('os', oldOS); } } if (oldVersion &lt; 8) { // change setting-slider values due to adding units _convertSliderValue('transitionTime'); _convertSliderValue('idleTime'); } _addDefaults(); // update state app.Data.processState(); }, /** * Restore default values for data saved in localStorage * @memberOf app.Data */ restoreDefaults: function() { Object.keys(_DEF_VALUES).forEach(function(key) { if ((key !== 'useGoogle') &amp;&amp; (key !== 'albumSelections')) { // skip Google photos settings app.Storage.set(key, _DEF_VALUES[key]); } }); // restore default time format based on locale app.Storage.set('showTime', _getTimeFormat()); // update state app.Data.processState(); }, /** * Process changes to localStorage items * @param {string} [key='all'] - the item that changed * @memberOf app.Data */ processState: function(key='all') { // Map processing functions to localStorage values const STATE_MAP = { 'enabled': _processEnabled, 'keepAwake': _processKeepAwake, 'activeStart': _processKeepAwake, 'activeStop': _processKeepAwake, 'allowSuspend': _processKeepAwake, 'idleTime': _processIdleTime, }; const noop = function() {}; let fn; if (key === 'all') { // process everything Object.keys(STATE_MAP).forEach(function(ky) { fn = STATE_MAP[ky]; return fn(); }); // process photo SOURCES app.PhotoSource.processAll(); // set os, if not already if (!app.Storage.get('os')) { _setOS().catch(() =&gt; {}); } } else { // individual change if (app.PhotoSource.contains(key)) { app.PhotoSource.process(key).catch((err) =&gt; { // send message on processing error const msg = app.Msg.PHOTO_SOURCE_FAILED; msg.key = key; msg.error = err.message; return app.Msg.send(msg); }).catch(() =&gt; {}); } else { (STATE_MAP[key] || noop)(); } } }, /** * Get the idle time in seconds * @returns {int} idle time in seconds * @memberOf app.Utils */ getIdleSeconds: function() { const idle = app.Storage.get('idleTime'); return idle.base * 60; }, }; })(); Ã— Search results Close "},"background_flickr.js.html":{"id":"background_flickr.js.html","title":"Source: background/flickr.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: background/flickr.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Interface to flickr API * @namespace */ app.Flickr = (function() { 'use strict'; new ExceptionHandler(); /** * Flickr rest API * @type {string} * @const * @default * @private * @memberOf app.Flickr */ const _URL_BASE = 'https://api.flickr.com/services/rest/'; /** * Flickr rest API authorization key * @type {string} * @const * @private * @memberOf app.Flickr */ const _KEY = '1edd9926740f0e0d01d4ecd42de60ac6'; /** * Max photos to return * @type {int} * @const * @default * @private * @memberOf app.Flickr */ const _MAX_PHOTOS = 250; /** * Extract the photos into an Array * @param {JSON} response - server response * @returns {Promise&lt;app.PhotoSource.SourcePhoto[]&gt;} Array of photos * @private * @memberOf app.Flickr */ function _processPhotos(response) { if (!response.photos || !response.photos.photo) { throw new Error(app.Utils.localize('err_photo_source_title')); } /** @(type) {PhotoSource.SourcePhoto[]} */ const photos = []; response.photos.photo.forEach((photo) =&gt; { if (photo &amp;&amp; photo.url_k &amp;&amp; (photo.media === 'photo') &amp;&amp; (photo.isfriend !== '0') &amp;&amp; (photo.isfamily !== '0')) { const width = parseInt(photo.width_k, 10); const height = parseInt(photo.height_k, 10); const asp = width / height; let pt = null; if (photo.latitude &amp;&amp; photo.longitude) { pt = app.PhotoSource.getPt(photo.latitude, photo.longitude); } app.PhotoSource.addPhoto(photos, photo.url_k, photo.ownername, asp, photo.owner, pt); } }); return Promise.resolve(photos); } return { /** * Get my photo album * @returns {Promise&lt;app.PhotoSource.SourcePhoto[]&gt;} Array of photos * @memberOf app.Flickr */ loadAuthorPhotos: function() { const userId = '86149994@N06'; const url = `${_URL_BASE}?method=flickr.people.getPublicPhotos` + `&amp;api_key=${_KEY}&amp;user_id=${userId}` + `&amp;extras=owner_name,url_k,media,geo&amp;per_page=${_MAX_PHOTOS}` + '&amp;format=json&amp;nojsoncallback=1'; return app.Http.doGet(url).then((response) =&gt; { if (response.stat !== 'ok') { throw new Error(response.message); } return _processPhotos(response); }); }, /** * Retrieve flickr photos * @returns {Promise&lt;app.PhotoSource.SourcePhoto[]&gt;} Array of photos * @memberOf app.Flickr */ loadPhotos: function() { const url = `${_URL_BASE}?method=flickr.interestingness.getList` + `&amp;api_key=${_KEY}&amp;extras=owner_name,url_k,media,geo` + `&amp;per_page=${_MAX_PHOTOS}` + '&amp;format=json&amp;nojsoncallback=1'; return app.Http.doGet(url).then((response) =&gt; { if (response.stat !== 'ok') { throw new Error(response.message); } return _processPhotos(response); }); }, }; })(); Ã— Search results Close "},"analytics.js.html":{"id":"analytics.js.html","title":"Source: analytics.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: analytics.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Manage Google Analytics tracking * @namespace */ app.GA = (function() { 'use strict'; /** * Tracking ID * @type {string} * @const * @default * @private * @memberOf app.GA */ const TRACKING_ID = 'UA-61314754-1'; /** * Google Analytics Event * @typedef {Object} GAEvent * @property {string} eventCategory - category * @property {string} eventAction - action * @property {string} eventLabel - label * @property {boolean} noInteraction - direct user interaction? */ /** * Event types * @type {{}} * @property {GAEvent} INSTALLED - extension installed * @property {GAEvent} MENU - menu selected * @property {GAEvent} TOGGLE - setting-toggle * @property {GAEvent} LINK - setting-link * @property {GAEvent} BUTTON - button click * @const * @memberOf app.GA */ const EVENT = { INSTALLED: { eventCategory: 'extension', eventAction: 'installed', eventLabel: '', }, MENU: { eventCategory: 'ui', eventAction: 'menuSelect', eventLabel: '', }, TOGGLE: { eventCategory: 'ui', eventAction: 'toggle', eventLabel: '', }, LINK: { eventCategory: 'ui', eventAction: 'linkSelect', eventLabel: '', }, BUTTON: { eventCategory: 'ui', eventAction: 'buttonClicked', eventLabel: '', }, ICON: { eventCategory: 'ui', eventAction: 'toolbarIconClicked', eventLabel: '', }, }; /** * Event: called when document and resources are loaded&lt;br /&gt; * Initialize Google Analytics * @private * @memberOf app.GA */ function _onLoad() { // Standard Google Universal Analytics code // noinspection OverlyComplexFunctionJS (function(i, s, o, g, r, a, m) { i['GoogleAnalyticsObject'] = r; // noinspection CommaExpressionJS i[r] = i[r] || function() { (i[r].q = i[r].q || []).push(arguments); }, i[r].l = 1 * new Date(); // noinspection CommaExpressionJS a = s.createElement(o), m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m); })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga'); ga('create', TRACKING_ID, 'auto'); // see: http://stackoverflow.com/a/22152353/1958200 ga('set', 'checkProtocolTask', function() { }); ga('set', 'appName', 'Photo Screensaver'); ga('set', 'appId', 'photo-screen-saver'); ga('set', 'appVersion', app.Utils.getVersion()); ga('require', 'displayfeatures'); } // listen for document and resources loaded window.addEventListener('load', _onLoad); return { EVENT: EVENT, /** * Send a page * @param {string} page - page path * @memberOf app.GA */ page: function(page) { if (page) { ga('send', 'pageview', page); } }, /** * Send an event * @param {GAEvent} event - the event type * @param {?string} [label=null] - override label * @param {?string} [action=null] - override action * @memberOf app.GA */ event: function(event, label=null, action=null) { if (event) { const ev = app.JSONUtils.shallowCopy(event); ev.hitType = 'event'; ev.eventLabel = label ? label : ev.eventLabel; ev.eventAction = action ? action : ev.eventAction; ga('send', ev); } }, /** * Send an error * @param {?string} [label=null] - override label * @param {?string} [action=null] - override action * @memberOf app.GA */ error: function(label=null, action=null) { const ev = { hitType: 'event', eventCategory: 'error', eventAction: 'unknownMethod', eventLabel: 'Err: unknown', }; ev.eventLabel = label ? `Err: ${label}` : ev.eventLabel; ev.eventAction = action ? action : ev.eventAction; ga('send', ev); console.error('Error: ', ev); }, /** * Send an exception * @param {string} message - the error message * @param {?string} [stack=null] - error stack * @param {boolean} [fatal=null] - true if fatal * @memberOf app.GA */ exception: function(message, stack = null, fatal = true) { try { let msg = ''; if (message) { msg += message; } if (stack) { msg += `\\n${stack}`; } const ex = { hitType: 'exception', exDescription: msg, exFatal: fatal, }; ga('send', ex); console.error('Exception caught: ', ex); } catch(err) { // noinspection BadExpressionStatementJS Function.prototype; } }, }; })(); Ã— Search results Close "},"screensaver_geo.js.html":{"id":"screensaver_geo.js.html","title":"Source: screensaver/geo.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: screensaver/geo.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Handle interaction the Google maps geocode API * @namespace */ app.Geo = (function() { 'use strict'; new ExceptionHandler(); /** * Path to Google's geocode api * @type {string} * @const * @default * @private * @memberOf app.Geo */ const _GEOCODE_API = 'http://maps.googleapis.com/maps/api/geocode/json'; /** * A Geo location * @typedef {Object} app.Geo.Location * @property {string} loc - descriptive location * @property {string} point - geo location 'lat lon' * @memberOf app.Geo */ /** * Cache of Geo Locations * @typedef {Object} app.Geo.Cache * @property {app.Geo.Location[]} entries - Array of locations * @property {int} maxSize - max entries to cache * @memberOf app.Geo */ /** * Location cache * @type {app.Geo.Cache} * @private * @memberOf app.Geo */ const _LOC_CACHE = { entries: [], maxSize: 100, }; /** * Try to get (@link app.Geo.Location} from cache * @param {string} point - a geolocation * @returns {app.Geo.Location|undefined} location, undefined if not cached * @memberOf app.Geo * @private */ function _getFromCache(point) { return _LOC_CACHE.entries.find((element) =&gt; { return (element.point === point); }); } /** * Try to get (@link app.Geo.Location} from cache * @param {string} point - a geolocation * @param {string} location - description * @memberOf app.Geo * @private */ function _addToCache(point, location) { _LOC_CACHE.entries.push({ loc: location, point: point, }); if (_LOC_CACHE.entries.length &gt; _LOC_CACHE.maxSize) { // FIFO _LOC_CACHE.entries.shift(); } } return { /** * Get the location string * @param {string} point - 'lat,long' * @returns {Promise&lt;string&gt;} geolocation as string * @memberOf app.Geo */ get: function(point) { if (!app.Storage.getBool('showLocation')) { throw new Error('showLocation is off'); } else if (app.Utils.isWhiteSpace(point)) { throw new Error('point is empty or null'); } // check cache const cache = _getFromCache(point); if (cache) { // retrieve from cache return Promise.resolve(cache.loc); } // get from api - it will translate based on the browser language const url = `${_GEOCODE_API}?sensor=true` + `&amp;latlng=${point}`; return app.Http.doGet(url, false, false, false, true, 2) .then((resp) =&gt; { let location = ''; if ((resp.status === 'OK') &amp;&amp; resp.results &amp;&amp; (resp.results.length &gt; 0)) { location = resp.results[0].formatted_address; // cache it _addToCache(point, location); } return Promise.resolve(location); }); }, }; })(); Ã— Search results Close "},"google_photos.js.html":{"id":"google_photos.js.html","title":"Source: google_photos.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: google_photos.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Interface to Picasa API * @namespace */ app.GooglePhotos = (function() { 'use strict'; new ExceptionHandler(); /** * A Google Photo Album * @typedef {Object} app.GooglePhotos.Album * @property {int} index - Array index * @property {string} uid - unique identifier * @property {string} name - album name * @property {string} id - Google album Id * @property {string} thumb - thumbnail url * @property {boolean} checked - is album selected * @property {int} ct - number of photos * @property {app.PhotoSource.SourcePhoto[]} photos - Array of photos * @memberOf app.GooglePhotos */ /** * A Selected Google Photo Album * @typedef {Object} app.GooglePhotos.SelectedAlbum * @property {string} id - Google album Id * @property {app.PhotoSource.SourcePhoto[]} photos - Array of photos * @memberOf app.GooglePhotos */ /** * Path to Picasa API * @type {string} * @const * @default * @private * @memberOf app.GooglePhotos */ const _URL_BASE = 'https://picasaweb.google.com/data/feed/api/user/'; /** * Query for list of albums * @type {string} * @const * @default * @private * @memberOf app.GooglePhotos */ const _ALBUMS_QUERY = '?max-results=2000&amp;visibility=all&amp;kind=album' + '&amp;fields=entry(gphoto:albumType,gphoto:id)&amp;v2&amp;alt=json'; /** * Query an album * @type {string} * @const * @default * @private * @memberOf app.GooglePhotos */ const _ALBUM_QUERY = '?imgmax=1600&amp;thumbsize=72' + '&amp;fields=title,gphoto:id,entry(media:group/media:content,' + 'media:group/media:credit,media:group/media:thumbnail,georss:where)' + '&amp;v=2&amp;alt=json'; /** Determine if a Picasa entry is an image * @param {Object} entry - Picasa media object * @returns {boolean} true if entry is a photo * @private * @memberOf app.GooglePhotos */ function _isImage(entry) { const content = entry.media$group.media$content; for (let i = 0; i &lt; content.length; i++) { if (content[i].medium !== 'image') { return false; } } return true; } /** Determine if a Picasa entry has Geo position * @param {Object} entry - Picasa media object * @returns {boolean} true if entry has Geo position * @private * @memberOf app.GooglePhotos */ function _hasGeo(entry) { return !!(entry.georss$where &amp;&amp; entry.georss$where.gml$Point &amp;&amp; entry.georss$where.gml$Point.gml$pos &amp;&amp; entry.georss$where.gml$Point.gml$pos.$t); } /** Get the thumbnail url if it exists * @param {Array} entry - Picasa media object * @returns {?string} url or null * @private * @memberOf app.GooglePhotos */ function _getThumbnail(entry) { let ret = null; if (entry.length &amp;&amp; entry[0].media$group &amp;&amp; entry[0].media$group.media$thumbnail[0]) { ret = entry[0].media$group.media$thumbnail[0].url; } return ret; } /** * Extract the Picasa photos into an Array * @param {Object} root - root object from Picasa API call * @returns {app.PhotoSource.SourcePhoto[]} Array of photos * @private * @memberOf app.GooglePhotos */ function _processPhotos(root) { const photos = []; if (root) { const feed = root.feed; const entries = feed.entry || []; entries.forEach((entry) =&gt; { if (_isImage(entry)) { const url = entry.media$group.media$content[0].url; const width = entry.media$group.media$content[0].width; const height = entry.media$group.media$content[0].height; const asp = width / height; const author = entry.media$group.media$credit[0].$t; let point; if (_hasGeo(entry)) { point = entry.georss$where.gml$Point.gml$pos.$t; } app.PhotoSource.addPhoto(photos, url, author, asp, {}, point); } }); } return photos; } /** * Retrieve a Google Photos album * @param {string} albumId - Picasa album ID * @param {string} [userId='default'] - userId for non-authenticated request * @returns {Promise&lt;Object&gt;} Root object from Picasa call null if not found * @private * @memberOf app.GooglePhotos */ function _loadPicasaAlbum(albumId, userId = 'default') { const url = `${_URL_BASE}${userId}/albumid/${albumId}/${_ALBUM_QUERY}`; if (userId === 'default') { return app.Http.doGet(url, true).catch((err) =&gt; { const statusMsg = `${app.Utils.localize('err_status')}: 404`; if (err.message.includes(statusMsg)) { // album was probably deleted return Promise.resolve(null); } else { throw err; } }); } else { return app.Http.doGet(url); } } return { /** * Retrieve the users list of albums, including the photos in each * @param {boolean} interactive - true is user initiated call * @returns {Promise&lt;app.GooglePhotos.Album[]&gt;} Array of albums * @memberOf app.GooglePhotos */ loadAlbumList: function(interactive = false) { const url = `${_URL_BASE}default/${_ALBUMS_QUERY}`; // get list of albums return app.Http.doGet(url, true, true, interactive).then((root) =&gt; { if (!root || !root.feed || !root.feed.entry) { throw new Error(app.Utils.localize('err_no_albums')); } const feed = root.feed; // series of API calls to get each album const promises = []; const entries = feed.entry || []; entries.forEach((entry) =&gt; { if (!entry.gphoto$albumType) { // skip special albums (e.g. Google+ posts, backups) const albumId = entry.gphoto$id.$t; promises.push(_loadPicasaAlbum(albumId)); } }); // Collate the albums return Promise.all(promises); }).then((vals) =&gt; { /** @type {app.GooglePhotos.Album[]} */ let albums = []; let ct = 0; const values = vals || []; values.forEach((value) =&gt; { if (value !== null) { const feed = value.feed; if (feed &amp;&amp; feed.entry) { const thumb = _getThumbnail(feed.entry); const photos = _processPhotos(value); if (photos &amp;&amp; photos.length) { /** @type {app.GooglePhotos.Album} */ const album = {}; album.index = ct; album.uid = 'album' + ct; album.name = feed.title.$t; album.id = feed.gphoto$id.$t; album.ct = photos.length; album.thumb = thumb; album.checked = false; album.photos = photos; albums.push(album); ct++; } } } }); return Promise.resolve(albums); }); }, /** * Retrieve the photos in the selected albums * @returns {Promise&lt;app.GooglePhotos.SelectedAlbum[]&gt;} Array albums * @memberOf app.GooglePhotos */ loadPhotos: function() { let vals = app.Storage.get('albumSelections'); // series of API calls to get each album const promises = []; const albums = vals || []; albums.forEach((album) =&gt; { promises.push(_loadPicasaAlbum(album.id)); }); // Collate the albums return Promise.all(promises).then((vals) =&gt; { /** @type {app.GooglePhotos.SelectedAlbum[]} */ const albums = []; const values = vals || []; values.forEach((value) =&gt; { if (value) { const feed = value.feed; const photos = _processPhotos(value); if (photos &amp;&amp; photos.length) { albums.push({ id: feed.gphoto$id.$t, photos: photos, }); } } }); return Promise.resolve(albums); }); }, }; })(); Ã— Search results Close "},"http.js.html":{"id":"http.js.html","title":"Source: http.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: http.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Fetch with authentication and exponential back-off * @namespace */ app.Http = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); /** * Authorization header * @const * @default * @private * @memberOf app.Http */ const _AUTH_HEADER = 'Authorization'; /** * Bearer parameter for authorized call * @const * @default * @private * @memberOf app.Http */ const _BEARER = 'Bearer'; /** * Max retries on 500 errors * @const * @default * @private * @memberOf app.Http */ const _MAX_RETRIES = 3; /** * Delay multiplier for exponential back-off * @const * @default * @private * @memberOf app.Http */ const _DELAY = 1000; /** * Check response and act accordingly * @param {{}} response - response from server * @param {string} url - server * @param {Object} opts - fetch options * @param {boolean} isAuth - true is authorization required * @param {boolean} retryToken - if true, retry with new token * @param {string} token - cached auth token * @param {boolean} interactive - true if user initiated * @param {int} attempt - the retry attempt we are on * @param {boolean} backoff - if true, do exponential back-off * @param {int} maxRetries - max retries * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf app.Http */ function _processResponse(response, url, opts, isAuth, retryToken, token, interactive, attempt, backoff, maxRetries) { if (response.ok) { // request succeeded - woo hoo! return response.json(); } if (attempt &gt;= maxRetries) { // request still failed after maxRetries return Promise.reject(_getError(response)); } const status = response.status; if (backoff &amp;&amp; (status &gt;= 500) &amp;&amp; (status &lt; 600)) { // temporary server error, maybe. Retry with backoff return _retry(url, opts, isAuth, retryToken, interactive, attempt, maxRetries); } if (isAuth &amp;&amp; token &amp;&amp; retryToken &amp;&amp; (status === 401)) { // could be expired token. Remove cached one and try again return _retryToken(url, opts, token, interactive, attempt, backoff, maxRetries); } if (isAuth &amp;&amp; interactive &amp;&amp; token &amp;&amp; retryToken &amp;&amp; (status === 403)) { // user may have revoked access to extension at some point // If interactive, retry so they can authorize again return _retryToken(url, opts, token, interactive, attempt, backoff, maxRetries); } // request failed return Promise.reject(_getError(response)); } /** * Get Error message * @param {{}} response - server response * @returns {Error} details on failure * @private * @memberOf app.Http */ function _getError(response) { let msg = 'Unknown error.'; if (response &amp;&amp; response.status &amp;&amp; (response.statusText !== undefined)) { const statusMsg = app.Utils.localize('err_status'); msg = `${statusMsg}: ${response.status}`; msg += `\\n${response.statusText}`; } return new Error(msg); } /** * Get authorization token * @param {boolean} isAuth - if true, authorization required * @param {boolean} interactive - if true, user initiated * @returns {Promise.&lt;string&gt;} auth token * @private * @memberOf app.Http */ function _getAuthToken(isAuth, interactive) { if (isAuth) { return chromep.identity.getAuthToken({ 'interactive': interactive, }).then((token) =&gt; { return Promise.resolve(token); }).catch((err) =&gt; { if (interactive &amp;&amp; (err.message.includes('revoked') || err.message .includes('Authorization page could not be loaded'))) { // try one more time non-interactively // Always returns Authorization page error // when first registering, Not sure why // Other message is if user revoked access to extension return chromep.identity.getAuthToken({ 'interactive': false, }); } else { throw err; } }); } else { // non-authorization branch return Promise.resolve(null); } } /** * Retry authorized fetch with exponential back-off * @param {string} url - server request * @param {Object} opts - fetch options * @param {boolean} isAuth - if true, authorization required * @param {boolean} retryToken - if true, retry with new token * @param {boolean} interactive - true if user initiated * @param {int} attempt - the retry attempt we are on * @param {int} maxRetries - max retries * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf app.Http */ function _retry(url, opts, isAuth, retryToken, interactive, attempt, maxRetries) { attempt++; // eslint-disable-next-line promise/avoid-new return new Promise((resolve, reject) =&gt; { const delay = (Math.pow(2, attempt) - 1) * _DELAY; setTimeout(() =&gt; { return _fetch(url, opts, isAuth, retryToken, interactive, attempt, true, maxRetries).then(resolve, reject); }, delay); }); } /** * Retry fetch after removing cached auth token * @param {string} url - server request * @param {Object} opts - fetch options * @param {string} token - cached auth token * @param {boolean} interactive - true if user initiated * @param {int} attempt - the retry attempt we are on * @param {boolean} backoff - if true, do exponential back-off * @param {int} maxRetries - max retries * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf app.Http */ function _retryToken(url, opts, token, interactive, attempt, backoff, maxRetries) { app.GA.error('Refresh auth token.', 'Http._retryToken'); return chromep.identity.removeCachedAuthToken({ token: token, }).then(() =&gt; { return _fetch(url, opts, true, false, interactive, attempt, backoff, maxRetries); }); } /** * Perform fetch, optionally using authorization and exponential back-off * @param {string} url - server request * @param {Object} opts - fetch options * @param {boolean} isAuth - if true, authorization required * @param {boolean} retryToken - if true, retry with new token * @param {boolean} interactive - if true, user initiated * @param {int} attempt - the retry attempt we are on * @param {boolean} backoff - if true, do exponential back-off * @param {int} maxRetries - max retries on 500 failures * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf app.Http */ function _fetch(url, opts, isAuth, retryToken, interactive, attempt, backoff, maxRetries) { let token = ''; return _getAuthToken(isAuth, interactive).then((authToken) =&gt; { if (isAuth) { token = authToken; opts.headers.set(_AUTH_HEADER, `${_BEARER} ${token}`); } return fetch(url, opts); }).then((response) =&gt; { return _processResponse(response, url, opts, isAuth, retryToken, token, interactive, attempt, backoff, maxRetries); }).catch((err) =&gt; { let msg = err.message; if (msg === 'Failed to fetch') { msg = app.Utils.localize('err_network'); } throw new Error(msg); }); } return { /** * Perform GET request to server, optionally using exponential back-off * and authorization * @param {string} url - server request * @param {boolean} [isAuth=false] - if true, authorization required * @param {boolean} [retryToken=false] - if true, retry with new token * @param {boolean} [interactive=false] - user initiated, if true * @param {boolean} [backoff=true] - if true, do exponential back-off * @param {int} [maxRetries=_MAX_ATTEMPTS] - max retries * @returns {Promise.&lt;json&gt;} response from server * @memberOf app.Http */ doGet: function(url, isAuth = false, retryToken = false, interactive = false, backoff = true, maxRetries = _MAX_RETRIES) { let attempt = 0; const opts = {method: 'GET', headers: new Headers({})}; if (isAuth) { opts.headers.set(_AUTH_HEADER, `${_BEARER} unknown`); } return _fetch(url, opts, isAuth, retryToken, interactive, attempt, backoff, maxRetries); }, }; })(); Ã— Search results Close "},"json.js.html":{"id":"json.js.html","title":"Source: json.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: json.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * JSON utilities * @namespace */ app.JSONUtils = (function() { 'use strict'; new ExceptionHandler(); return { /** * Parse JSON, with exception handling * @param {!string} jsonString - string to parse * @returns {?JSON} JSON Object, null on error * @memberOf app.JSONUtils */ parse: function(jsonString) { let ret = null; try { ret = JSON.parse(jsonString); } catch (err) { app.GA.exception(`JSONUtils.parse: ${err.message}`, err.stack, false); } return ret; }, /** * Return shallow copy of Object * @param {!Object} object - object to copy * @returns {?JSON} JSON Object, null on error * @memberOf app.JSONUtils */ shallowCopy: function(object) { let ret = null; const jsonString = JSON.stringify(object); if (typeof(jsonString) !== 'undefined') { ret = app.JSONUtils.parse(jsonString); } return ret; }, }; })(); Ã— Search results Close "},"msg.js.html":{"id":"msg.js.html","title":"Source: msg.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: msg.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Wrapper for chrome messages * @namespace */ app.Msg = (function() { 'use strict'; new ExceptionHandler(); /** * A Chrome message * @typedef {{}} app.Msg.Message * @property {string} message - Unique name * @property {Error} error - an error * @property {string} key - key name * @property {?Object} value - value of key * @memberOf app.Msg */ /** * Show {@link app.ScreenSaver} * @type {app.Msg.Message} * @memberOf app.Msg */ const SS_SHOW = { message: 'showScreensaver', }; /** * Close {@link app.ScreenSaver} * @type {app.Msg.Message} * @memberOf app.Msg */ const SS_CLOSE = { message: 'closeScreensaver', }; /** * Is a {@link app.ScreenSaver} showing * @type {app.Msg.Message} * @memberOf app.Msg */ const SS_IS_SHOWING = { message: 'isScreensaverShowing', }; /** * Restore default settings * @type {app.Msg.Message} * @memberOf app.Msg */ const RESTORE_DEFAULTS = { message: 'restoreDefaults', }; /** * Highlight a tab * @type {app.Msg.Message} * @memberOf app.Msg */ const HIGHLIGHT = { message: 'highlightTab', }; /** * A save attempt to localStorage exceeded its capacity * @type {app.Msg.Message} * @memberOf app.Msg */ const STORAGE_EXCEEDED = { message: 'storageExceeded', }; /** * An {@link app.PhotoSource} server request failed * @type {app.Msg.Message} * @memberOf app.Msg */ const PHOTO_SOURCE_FAILED = { message: 'photoSourceFailed', key: '', error: '', }; /** * Save value to storage message * @type {app.Msg.Message} * @memberOf app.Msg */ const STORE = { message: 'store', key: '', value: '', }; return { SS_SHOW: SS_SHOW, SS_CLOSE: SS_CLOSE, SS_IS_SHOWING: SS_IS_SHOWING, RESTORE_DEFAULTS: RESTORE_DEFAULTS, HIGHLIGHT: HIGHLIGHT, STORAGE_EXCEEDED: STORAGE_EXCEEDED, PHOTO_SOURCE_FAILED: PHOTO_SOURCE_FAILED, STORE: STORE, /** * Send a chrome message * @param {app.Msg.Message} type - type of message * @returns {Promise&lt;JSON&gt;} response JSON * @memberOf app.Msg */ send: function(type) { const chromep = new ChromePromise(); return chromep.runtime.sendMessage(type, null).then((response) =&gt; { return Promise.resolve(response); }).catch((err) =&gt; { if (err.message &amp;&amp; !err.message.includes('port closed') &amp;&amp; !err.message.includes('Receiving end does not exist')) { const msg = `type: ${type.message}, ${err.message}`; app.GA.error(msg, 'Msg.send'); } return Promise.reject(err); }); }, /** * Add a listener for chrome messages * @param {Function} listener - function to receive messages * @memberOf app.Msg */ listen: function(listener) { chrome.runtime.onMessage.addListener(listener); }, }; })(); Ã— Search results Close "},"options_options.js.html":{"id":"options_options.js.html","title":"Source: options/options.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: options/options.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ (function() { 'use strict'; /** * Extension's Options page * @namespace app.Options */ new ExceptionHandler(); /** * Manage an html page that is inserted on demand&lt;br /&gt; * May also be a url link to external site * @typedef {{}} Options.Page * @property {string} label - label for Nav menu * @property {string} route - element name route to page * @property {string} icon - icon for Nav Menu * @property {?Object|Function} obj - something to be done when selected * @property {boolean} ready - true if html is inserted * @property {boolean} divider - true for divider before item * @memberOf app.Options */ /** * Path to the extension in the Web Store * @type {string} * @const * @private * @memberOf app.Options */ const EXT_URI = 'https://chrome.google.com/webstore/detail/photo-screen-saver/' + chrome.runtime.id + '/'; /** * Path to my Pushy Clipboard extension * @type {string} * @const * @default * @private * @memberOf app.Options */ const PUSHY_URI = 'https://chrome.google.com/webstore/detail/pushy-clipboard/' + 'jemdfhaheennfkehopbpkephjlednffd'; /** * auto-binding template * @type {Object} * @const * @private * @memberOf app.Options */ const t = document.querySelector('#t'); /** * Array of pages * @type {Options.Page[]} * @memberOf app.Options */ t.pages = [ { label: app.Utils.localize('menu_settings'), route: 'page-settings', icon: 'myicons:settings', obj: null, ready: true, divider: false, }, { label: app.Utils.localize('menu_google'), route: 'page-google-photos', icon: 'myicons:cloud', obj: _showGooglePhotosPage, ready: false, divider: false, }, { label: app.Utils.localize('menu_preview'), route: 'page-preview', icon: 'myicons:pageview', obj: _showScreensaverPreview, ready: true, divider: false, }, { label: app.Utils.localize('menu_help'), route: 'page-help', icon: 'myicons:help', obj: _showHelpPage, ready: false, divider: false, }, { label: app.Utils.localize('menu_support'), route: 'page-support', icon: 'myicons:help', obj: `${EXT_URI}support`, ready: true, divider: true, }, { label: app.Utils.localize('menu_rate'), route: 'page-rate', icon: 'myicons:grade', obj: `${EXT_URI}reviews`, ready: true, divider: false, }, { label: app.Utils.localize('menu_pushy'), route: 'page-pushy', icon: 'myicons:extension', obj: PUSHY_URI, ready: true, divider: true, }, ]; // Error dialog t.dialogTitle = ''; t.dialogText = ''; /** * Current {@link Options.Page} * @type {string} * @memberOf app.Options */ t.route = 'page-settings'; /** * Event Listener for template bound event to know when bindings * have resolved and content has been stamped to the page * @memberOf app.Options */ t.addEventListener('dom-change', function() { app.GA.page('/options.html'); // listen for chrome messages app.Msg.listen(_onMessage); }); /** * Event: navigation menu selected * Route to proper page * @param {Event} event - ClickEvent * @memberOf app.Options */ t._onNavMenuItemTapped = function(event) { // Close drawer after menu item is selected if it is narrow const drawerPanel = document.querySelector('#paperDrawerPanel'); if (drawerPanel &amp;&amp; drawerPanel.narrow) { drawerPanel.closeDrawer(); } const index = t.pages.findIndex((element) =&gt; { return element.route === event.currentTarget.id; }); app.GA.event(app.GA.EVENT.MENU, t.pages[index].route); const prevRoute = t.route; if (!t.pages[index].obj) { // some pages are just pages t.route = t.pages[index].route; _scrollPageToTop(); } else if (typeof t.pages[index].obj === 'string') { // some pages are url links t.$.mainMenu.select(prevRoute); chrome.tabs.create({url: t.pages[index].obj}); } else { // some pages have functions to view them t.pages[index].obj(index, prevRoute); } }; /** * Computed property: Page title * @returns {string} i18n title * @memberOf app.Options */ t._computeTitle = function() { return app.Utils.localize('chrome_extension_name'); }; /** * Computed property: Menu label * @returns {string} i18n label * @memberOf app.Options */ t._computeMenu = function() { return app.Utils.localize('menu'); }; /** * Show the Google Photos page * @param {int} index - index into [t.pages]{@link Options.t.pages} * @memberOf app.Options */ function _showGooglePhotosPage(index) { if (!t.pages[index].ready) { // create the page the first time t.pages[index].ready = true; t.gPhotosPage = new app.GooglePhotosPage('gPhotosPage'); Polymer.dom(t.$.googlePhotosInsertion).appendChild(t.gPhotosPage); } else { t.gPhotosPage.loadAlbumList(); } t.route = t.pages[index].route; _scrollPageToTop(); } /** * Show the help page * @param {int} index - index into [t.pages]{@link Options.t.pages} * @private * @memberOf app.Options */ function _showHelpPage(index) { if (!t.pages[index].ready) { // insert the page the first time t.pages[index].ready = true; const el = new app.HelpPageFactory(); Polymer.dom(t.$.helpInsertion).appendChild(el); } t.route = t.pages[index].route; _scrollPageToTop(); } // noinspection JSUnusedLocalSymbols /** * Display a preview of the screen saver * @param {int} index - index into [t.pages]{@link Options.t.pages} * @param {string} prevRoute - last page selected * @memberOf app.Options */ function _showScreensaverPreview(index, prevRoute) { // reselect previous page - need to delay so tap event is done t.async(function() { t.$.mainMenu.select(prevRoute); }, 500); app.Msg.send(app.Msg.SS_SHOW).catch(() =&gt; {}); } /** * Scroll page to top * @memberOf app.Options */ function _scrollPageToTop() { t.$.scrollPanel.scrollToTop(true); } // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {app.Msg.Message} request - details for the message * @param {Object} [sender] - MessageSender object * @param {Function} [response] - function to call once after processing * @returns {boolean} true if asynchronous * @private * @memberOf app.Options */ function _onMessage(request, sender, response) { if (request.message === app.Msg.HIGHLIGHT.message) { // highlight ourselves and let the sender know we are here const chromep = new ChromePromise(); chromep.tabs.getCurrent().then((t) =&gt; { chrome.tabs.update(t.id, {'highlighted': true}); return null; }).catch((err) =&gt; { app.GA.error(err.message, 'chromep.tabs.getCurrent'); }); response(JSON.stringify({message: 'OK'})); } else if (request.message === app.Msg.STORAGE_EXCEEDED.message) { // Display Error Dialog if a save action exceeded the // localStorage limit t.dialogTitle = app.Utils.localize('err_storage_title'); t.dialogText = app.Utils.localize('err_storage_desc'); t.$.errorDialog.open(); } else if (request.message === app.Msg.PHOTO_SOURCE_FAILED.message) { // failed to load t.$.settingsPage.deselectPhotoSource(request.key); t.dialogTitle = app.Utils.localize('err_photo_source_title'); t.dialogText = request.error; t.$.errorDialog.open(); } return false; } })(); Ã— Search results Close "},"options_permissions.js.html":{"id":"options_permissions.js.html","title":"Source: options/permissions.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: options/permissions.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Handle optional permissions * @namespace */ app.Permissions = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); /** * A permission state enum * @typedef {{}} app.Permissions.State * @property {string} notSet - never been allowed or denied * @property {string} allowed - user allowed * @property {string} denied - user denied * @memberOf app.Permissions */ /** * A permission type * @typedef {{}} app.Permissions.Type * @property {string} name - name in localStorage * @property {string[]} permissions - array of permissions * @property {string[]} origins - array of origins * @memberOf app.Permissions */ /** * Possible states of an {@link app.Permissions.Type} * @type {app.Permissions.State} * @const * @private * @memberOf app.Permissions */ const _STATE = { notSet: 'notSet', allowed: 'allowed', denied: 'denied', }; /** * Permission for access to users' Google Photos * @const * @type {app.Permissions.Type} * @memberOf app.Permissions */ const PICASA = { name: 'permPicasa', permissions: [], origins: ['https://picasaweb.google.com/'], }; /** * Persist the state of an {@link app.Permissions.Type} * @param {app.Permissions.Type} type - permission type * @param {string} value - permission state * @private * @memberOf app.Permissions */ function _setState(type, value) { // send message to store value so items that are bound // to it will get storage event const msg = app.JSONUtils.shallowCopy(app.Msg.STORE); msg.key = type.name; msg.value = value; app.Msg.send(msg).catch(() =&gt; {}); } /** * Determine if we have the optional permissions * @param {app.Permissions.Type} type - permission type * @returns {Promise&lt;boolean&gt;} true if we have permissions * @memberOf app.Permissions */ function _contains(type) { return chromep.permissions.contains({ permissions: type.permissions, origins: type.origins, }); } /** * Remove the optional permissions * @param {app.Permissions.Type} type - permission type * @returns {Promise&lt;boolean&gt;} true if removed * @private * @memberOf app.Permissions */ function _remove(type) { return _contains(type).then((contains) =&gt; { if (contains) { // try to remove permission return chromep.permissions.remove({ permissions: type.permissions, origins: type.origins, }); } else { return Promise.resolve(false); } }); } return { /** @type {app.Permissions.Type} */ PICASA: PICASA, /** * Has user made choice on permissions * @param {app.Permissions.Type} type - permission type * @returns {boolean} true if allowed or denied * @memberOf app.Permissions */ notSet: function(type) { return app.Storage.get(type.name) === _STATE.notSet; }, /** * Has the user allowed the optional permissions * @param {app.Permissions.Type} type - permission type * @returns {boolean} true if allowed * @memberOf app.Permissions */ isAllowed: function(type) { return app.Storage.get(type.name) === _STATE.allowed; }, /** * Request optional permission - may block * @param {app.Permissions.Type} type - permission type * @returns {Promise&lt;boolean&gt;} true if permission granted * @memberOf app.Permissions */ request: function(type) { let isGranted; return chromep.permissions.request({ permissions: type.permissions, origins: type.origins, }).then((granted) =&gt; { isGranted = granted; if (granted) { _setState(type, _STATE.allowed); return Promise.resolve(); } else { _setState(type, _STATE.denied); // try to remove if it has been previously granted return _remove(type); } }).then(() =&gt; { return Promise.resolve(isGranted); }); }, }; })(); Ã— Search results Close "},"screensaver_photo.js.html":{"id":"screensaver_photo.js.html","title":"Source: screensaver/photo.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: screensaver/photo.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ (function() { 'use strict'; new ExceptionHandler(); /** * aspect ratio of screen * @type {number} * @const * @private * @memberOf app.Photo */ const _SCREEN_ASP = screen.width / screen.height; /** * A photo for the screen saver * Important: Only implement static methods. This Object * will be shallow copied in the screensaver and lose its instance methods * * @property {string} name - Unique name * @property {string} path - The url to the photo * @property {string} author - The photographer * @property {string} type - type of {@link app.PhotoSource} * @property {int} width - width * @property {int} height - height * @property {number} aspectRatio - aspect ratio * @property {Object} ex - additional information about the photo * @property {string} point - geolocation 'lat lon' * @property {string} label - author label * @property {?string} location - geolocation label * @param {string} name - unique name * @param {app.PhotoSource.SourcePhoto} source - source photo * @param {string} sourceType - type of {@link app.PhotoSource} * @constructor * @alias app.Photo */ const Photo = function(name, source, sourceType) { this.name = name; this.path = source.url; this.author = source.author ? source.author : ''; this.type = sourceType; this.aspectRatio = source.asp; this.ex = source.ex; this.point = source.point; this.width = screen.width; this.height = screen.height; this.label = Photo.buildAuthorLabel(this.type, this.author, false); this.location = null; }; window.app = window.app || {}; app.Photo = Photo; /** * Create the author label * @param {string} type - source of photo * @param {string} author - author of photo * @param {boolean} force - require display of label if true * @returns {string} label describing the photo source and photographer name */ Photo.buildAuthorLabel = function(type, author, force) { let ret = ''; let newType = type; const idx = type.search('User'); if (!force &amp;&amp; !app.Storage.getBool('showPhotog') &amp;&amp; (idx !== -1)) { // don't show label for user's own photos, if requested return ret; } if (idx !== -1) { // strip off 'User' newType = type.substring(0, idx - 1); } if (author) { ret = `${author} / ${newType}`; } else { // no photographer name ret = `${app.Utils.localize('photo_from')} ${newType}`; } return ret; }; /** * Determine if a photo would look bad zoomed or stretched on the screen * @param {number} asp aspect ratio of photo * @returns {boolean} true if a photo aspect ratio differs substantially * from the screens' * @private */ Photo._isBadAspect = function(asp) { // arbitrary const CUT_OFF = 0.5; return (asp &lt; _SCREEN_ASP - CUT_OFF) || (asp &gt; _SCREEN_ASP + CUT_OFF); }; /** * Determine if a photo should not be displayed * @param {number} asp - aspect ratio * @param {int} photoSizing - the sizing type * @returns {boolean} true if the photo should not be displayed */ Photo.ignore = function(asp, photoSizing) { let ret = false; const skip = app.Storage.getBool('skip'); if ((!asp || isNaN(asp)) || (skip &amp;&amp; ((photoSizing === 1) || (photoSizing === 3)) &amp;&amp; Photo._isBadAspect(asp))) { // ignore photos that don't have aspect ratio // or would look bad with cropped or stretched sizing options ret = true; } return ret; }; /** * Create a new tab with a link to the * original source of the current photo, if possible * @param {Object} item - a photo item */ Photo.showSource = function(item) { if (!item) { return; } const path = item.path; const extra = item.ex; let regex; let id; let url; switch (item.type) { case '500': // parse photo id regex = /(\\/[^\\/]*){4}/; id = path.match(regex); url = `http://500px.com/photo${id[1]}`; chrome.tabs.create({url: url}); break; case 'flickr': if (extra) { // parse photo id regex = /(\\/[^\\/]*){4}(_.*_)/; id = path.match(regex); url = `https://www.flickr.com/photos/${item.ex}${id[1]}`; chrome.tabs.create({url: url}); } break; case 'reddit': if (extra) { chrome.tabs.create({url: item.ex}); } break; default: break; } }; })(); Ã— Search results Close "},"photo_sources.js.html":{"id":"photo_sources.js.html","title":"Source: photo_sources.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: photo_sources.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ (function() { 'use strict'; new ExceptionHandler(); /** * A potential source of photos for the screensaver * * @param {string} useName - The key for if the source is selected * @param {string} photosName - The key for the collection of photos * @param {string} type - A descriptor of the photo source * @param {boolean} isDaily - Should the source be updated daily * @param {boolean} isArray - Is the source an Array of photo Arrays * @param {string} loadObj - function wrapper, as a string * @param {string} loadFn - function to load photos, as a string * @param {Array} loadArgs - Arguments to the loadFn * @constructor * @alias app.PhotoSource */ const PhotoSource = function(useName, photosName, type, isDaily, isArray, loadObj, loadFn, loadArgs) { this.useName = useName; this.photosName = photosName; this.type = type; this.isDaily = isDaily; this.isArray = isArray; this.loadObj = loadObj; this.loadFn = loadFn; this.loadArgs = loadArgs || []; }; window.app = window.app || {}; app.PhotoSource = PhotoSource; /** * A photo from a {@link app.PhotoSource} * This is the photo information that is persisted. * * @typedef {{}} app.PhotoSource.SourcePhoto * @property {string} url - The url to the photo * @property {string} author - The photographer * @property {number} asp - The aspect ratio of the photo * @property {Object} [ex] - Additional information about the photo * @property {string} [point] - geolocation 'lat lon' */ /** * The photos for a {@link app.PhotoSource} * * @typedef {{}} app.PhotoSource.SourcePhotos * @property {string} type - type of {@link app.PhotoSource} * @property {app.PhotoSource.SourcePhoto[]} photos - The photos */ /** * Array of PhotoSources * @private * @type {app.PhotoSource[]} */ PhotoSource._SRCS = [ new PhotoSource('useGoogle', 'albumSelections', 'Google User', true, true, 'GooglePhotos', 'loadPhotos', []), new PhotoSource('useChromecast', 'ccImages', 'Google', false, false, 'ChromeCast', 'loadPhotos', []), new PhotoSource('useEditors500px', 'editors500pxImages', '500', true, false, 'Use500px', 'loadPhotos', ['editors']), new PhotoSource('usePopular500px', 'popular500pxImages', '500', true, false, 'Use500px', 'loadPhotos', ['popular']), new PhotoSource('useYesterday500px', 'yesterday500pxImages', '500', true, false, 'Use500px', 'loadPhotos', ['fresh_yesterday']), new PhotoSource('useSpaceReddit', 'spaceRedditImages', 'reddit', true, false, 'Reddit', 'loadPhotos', ['r/spaceporn/']), new PhotoSource('useEarthReddit', 'earthRedditImages', 'reddit', true, false, 'Reddit', 'loadPhotos', ['r/EarthPorn/']), new PhotoSource('useAnimalReddit', 'animalRedditImages', 'reddit', true, false, 'Reddit', 'loadPhotos', ['r/animalporn/']), new PhotoSource('useInterestingFlickr', 'flickrInterestingImages', 'flickr', true, false, 'Flickr', 'loadPhotos', []), new PhotoSource('useAuthors', 'authorImages', 'flickr', false, false, 'Flickr', 'loadAuthorPhotos', []), ]; /** * Determine if this source has been selected for display * @returns {boolean} true if selected */ PhotoSource.prototype.use = function() { return app.Storage.getBool(this.useName); }; /** * Process the photo source. * This normally requires a https call and may fail for various reasons * @returns {Promise&lt;void&gt;} void */ PhotoSource.prototype.process = function() { if (this.use()) { // convert string to function const fn = window.app[this.loadObj][this.loadFn]; let arg = null; if (this.loadArgs.length === 1) { arg = this.loadArgs[0]; } return fn(arg).then((photos) =&gt; { const err = this._savePhotos(photos); if (err) { throw new Error(err); } return Promise.resolve(); }).catch((err) =&gt; { if (err.message === app.Utils.localize('err_network')) { app.GA.error(err.message, 'PhotoSource.process'); } else { app.GA.error(err.message, `PhotoSource.process(${this.useName})`); } return Promise.reject(err); }); } else { if (this.useName !== 'useGoogle') { localStorage.removeItem(this.photosName); } return Promise.resolve(); } }; /** * Save the photos to localStorage in a safe manner * @param {app.PhotoSource.SourcePhoto[]} photos * - {@link app.PhotoSource.SourcePhoto} Array * @returns {?string} non-null on error * @private */ PhotoSource.prototype._savePhotos = function(photos) { let ret = null; const keyBool = (this.useName === 'useGoogle') ? null : this.useName; if (photos || photos.length) { const set = app.Storage.safeSet(this.photosName, photos, keyBool); if (!set) { ret = 'Exceeded storage capacity.'; } } return ret; }; /** * Get the photos from local storage * @returns {app.PhotoSource.SourcePhotos} the photos * @private */ PhotoSource.prototype._getPhotos = function() { let ret = { type: this.type, photos: [], }; if (this.use()) { let photos = []; if (this.isArray) { let items = app.Storage.get(this.photosName); // could be that items have not been retrieved yet items = items || []; items.forEach((item) =&gt; { photos = photos.concat(item.photos); }); } else { photos = app.Storage.get(this.photosName); // could be that items have not been retrieved yet photos = photos || []; } ret.photos = photos; } return ret; }; /** * Get all the keys of useage boolean variables * @returns {string[]} Array of keys of useage boolean variables */ PhotoSource.getUseNames = function() { let ret = []; PhotoSource._SRCS.forEach((source) =&gt; { ret = ret.concat(source.useName); }); return ret; }; /** * Get all the photos from all selected sources. These will be * used by the screensaver. * @returns {app.PhotoSource.SourcePhotos[]} Array of sources photos */ PhotoSource.getSelectedPhotos = function() { let ret = []; PhotoSource._SRCS.forEach((source) =&gt; { ret.push(source._getPhotos()); }); return ret; }; /** * Determine if a given string is a photo source * @param {string} useName - String to check * @returns {boolean} true if photo source */ PhotoSource.contains = function(useName) { for (let i = 0; i &lt; PhotoSource._SRCS.length; i++) { if (PhotoSource._SRCS[i].useName === useName) { return true; } } return false; }; /** * Process the given photo source and save to localStorage. * This normally requires a https call and may fail for various reasons * @param {string} useName - The photo source to retrieve * @returns {Promise&lt;void&gt;} void */ PhotoSource.process = function(useName) { for (let i = 0; i &lt; PhotoSource._SRCS.length; i++) { if (PhotoSource._SRCS[i].useName === useName) { return PhotoSource._SRCS[i].process(); } } // not found, shouldn't be here return Promise.resolve(); }; /** * Process all the selected photo sources. * This normally requires a https call and may fail for various reasons */ PhotoSource.processAll = function() { PhotoSource._SRCS.forEach((source) =&gt; { source.process().catch(() =&gt; {}); }); }; /** * Process all the selected photo sources that are to be * updated every day. * This normally requires a https call and may fail for various reasons */ PhotoSource.processDaily = function() { PhotoSource._SRCS.forEach((source) =&gt; { if (source.isDaily) { source.process().catch(() =&gt; {}); } }); }; /** * Get a geo point string from a latitude and longitude * @param {number} lat - latitude * @param {number} lon - longitude * @returns {string} 'lat lon' */ PhotoSource.getPt = function(lat, lon) { if ((typeof lat === 'number') &amp;&amp; (typeof lon === 'number')) { return `${lat.toPrecision(8)} ${lon.toPrecision(8)}`; } else { return `${lat} ${lon}`; } }; /** * Add a {@link app.PhotoSource.SourcePhoto} to an existing Array * @param {Array} photos - {@link app.PhotoSource.SourcePhoto} Array * @param {string} url - The url to the photo * @param {string} author - The photographer * @param {number} asp - The aspect ratio of the photo * @param {Object} [ex] - Additional information about the photo * @param {string} [point] - 'lat lon' */ PhotoSource.addPhoto = function(photos, url, author, asp, ex, point) { /** @type {app.PhotoSource.SourcePhoto} */ const photo = { url: url, author: author, asp: asp.toPrecision(3), }; if (ex) { photo.ex = ex; } if (point) { photo.point = point; } photos.push(photo); }; })(); Ã— Search results Close "},"background_reddit.js.html":{"id":"background_reddit.js.html","title":"Source: background/reddit.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: background/reddit.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Interface to Reddit API * @namespace */ app.Reddit = (function() { 'use strict'; new ExceptionHandler(); /** * Extension's redirect uri * @type {string} * @const * @private * @memberOf app.Reddit */ const _REDIRECT_URI = `https://${chrome.runtime.id}.chromiumapp.org/reddit`; /** * Reddit rest API authorization key * @type {string} * @const * @private * @memberOf app.Reddit */ const _KEY = 'bATkDOUNW_tOlg'; /** * Max photos to return * @type {int} * @const * @default * @private * @memberOf app.Reddit */ const _MAX_PHOTOS = 100; /** * Min size of photo to use * @type {int} * @const * @default * @private * @memberOf app.Reddit */ const _MIN_SIZE = 750; /** * Max size of photo to use * @type {int} * @const * @default * @private * @memberOf app.Reddit */ const _MAX_SIZE = 3500; /** * Expose reddit API * @type {Function} * @const * @private * @memberOf app.Reddit */ const _snoocore = new Snoocore({ userAgent: 'photo-screen-saver', throttle: 0, oauth: { type: 'implicit', key: _KEY, redirectUri: _REDIRECT_URI, scope: ['read'], }, }); /** * Parse the size from the submission title. * this is the old way reddit did it * @param {string} title - submission title * @returns {{width: int, height: int}} Photo size * @private * @memberOf app.Reddit */ function _getSize(title) { const ret = {width: -1, height: -1}; const regex = /\\[(\\d*)\\D*(\\d*)\\]/; const res = title.match(regex); if (res) { ret.width = parseInt(res[1], 10); ret.height = parseInt(res[2], 10); } return ret; } /** * Build the list of photos for one page of items * @param {Array} children - Array of objects from reddit * @returns {app.PhotoSource.SourcePhoto[]} Array of photos * @private * @memberOf app.Reddit */ function _processChildren(children) { const photos = []; let url; let width = 1; let height = 1; children.forEach((child) =&gt; { const data = child.data; if (!data.over_18) { // skip NSFW if (data.preview &amp;&amp; data.preview.images) { // new way. has full size image and array of reduced // resolutions let item = data.preview.images[0]; url = item.source.url; width = parseInt(item.source.width, 10); height = parseInt(item.source.height, 10); if (Math.max(width, height) &gt; _MAX_SIZE) { // too big. get the largest reduced resolution image item = item.resolutions[item.resolutions.length - 1]; url = item.url.replace(/&amp;amp;/g, '&amp;'); width = parseInt(item.width, 10); height = parseInt(item.height, 10); } } else if (data.title) { // old way of specifying images - parse size from title const size = _getSize(data.title); url = data.url; width = size.width; height = size.height; } } const asp = width / height; const author = data.author; if (asp &amp;&amp; !isNaN(asp) &amp;&amp; (Math.max(width, height) &gt;= _MIN_SIZE) &amp;&amp; (Math.max(width, height) &lt;= _MAX_SIZE)) { app.PhotoSource.addPhoto(photos, url, author, asp, data.url); } }); return photos; } return { /** * Retrieve the array of reddit photos * @param {string} subreddit - name of photo subreddit * @returns {Promise&lt;app.PhotoSource.SourcePhoto[]&gt;} Array of photos * @memberOf app.Reddit */ loadPhotos: function(subreddit) { let photos = []; return _snoocore(`${subreddit}hot`).listing({ limit: _MAX_PHOTOS, }).then((slice) =&gt; { photos = photos.concat(_processChildren(slice.children)); return slice.next(); }).then((slice) =&gt; { photos = photos.concat(_processChildren(slice.children)); return Promise.resolve(photos); }).catch((err) =&gt; { let msg = err.message; if (msg) { // extract first sentence const idx = msg.indexOf('.'); if (idx !== -1) { msg = msg.substring(0, idx + 1); } } else { msg = 'Unknown Error'; } throw new Error(msg); }); }, }; })(); Ã— Search results Close "},"screensaver_screensaver.js.html":{"id":"screensaver_screensaver.js.html","title":"Source: screensaver/screensaver.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: screensaver/screensaver.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ (function() { 'use strict'; /** * Display a screen saver * @namespace app.ScreenSaver */ new ExceptionHandler(); /** * repeating alarm for updating time label * @type {string} * @const * @default * @private * @memberOf app.ScreenSaver */ const _CLOCK_ALARM = 'updateTimeLabel'; // set selected background image document.body.style.background = app.Storage.get('background').substring(11); /** * main auto-bind template * @type {Object} * @const * @private * @memberOf app.ScreenSaver */ const t = document.querySelector('#t'); // repeat template t.rep = null; // neon-animated-pages element t.p = null; /** * array of all the {@link app.Photo} to use for slide show * @type {Array} * @memberOf app.ScreenSaver */ t.photos = []; /** * Index into [t.photos]{@link app.ScreenSaver.t.photos} * @type {int} * @memberOf app.ScreenSaver */ t.curIdx = 0; /** * Array of {@link app.SSView} objects bound to the neon-animated-pages. * The {@link app.Photo} property is an always changing subset of * [t.photos]{@link app.ScreenSaver.t.photos} * @type {Array} * @memberOf app.ScreenSaver */ t.views = []; // the last selected page t.lastSelected = -1; // true after first full page animation t.started = false; // Flag to indicate the screen saver has no photos t.noPhotos = false; // Starting mouse position t.startMouse = {x: null, y: null}; /** * Event Listener for template bound event to know when bindings * have resolved and content has been stamped to the page * @memberOf app.ScreenSaver */ t.addEventListener('dom-change', function() { // listen for chrome messages app.Msg.listen(_onMessage); app.GA.page('/screensaver.html'); t.rep = t.$.repeatTemplate; t.p = t.$.pages; t.time = ''; app.SSUtils.setZoom(); app.SSUtils.setupPhotoSizing(t); _processPhotoTransitions(); // load the photos for the slide show app.SSUtils.loadPhotos(t); if (!t.noPhotos) { // kick off the slide show if there are photos selected // slight delay at beginning so we have a smooth start t.waitTime = 2000; t.timer = window.setTimeout(_runShow, t.waitTime); } }); /** * Event: Slide animation finished * @memberOf app.ScreenSaver */ t._OnAniFinished = function() { // replace the previous selected with the next one from master array // do it here so the web request doesn't run during transition if (t.replaceLast &gt;= 0) { _replacePhoto(t.replaceLast, false); } if (t.views[t.prevPage].isError(t.prevPage)) { // broken link, mark it and replace it if (t.prevPage &gt;= 0) { _replacePhoto(t.prevPage, true); } } }; /** * Computed property: No photos label * @returns {string} i18n label * @memberOf app.ScreenSaver */ t._computeNoPhotos = function() { return `${app.Utils.localize('no')} ${app.Utils.localize('photos')}`; }; /** * Process settings related to between photo transitions * @memberOf app.ScreenSaver */ function _processPhotoTransitions() { t.transitionType = app.Storage.getInt('photoTransition', 0); if (t.transitionType === 8) { // pick random transition t.transitionType = app.Utils.getRandomInt(0, 7); } const trans = app.Storage.get('transitionTime'); t.transitionTime = trans.base * 1000; t.waitTime = t.transitionTime; t.waitForLoad = true; const showTime = app.Storage.getInt('showTime', 0); if ((showTime !== 0) &amp;&amp; (trans.base &gt; 60)) { // add repeating alarm to update time label // if transition time is more than 1 minute // and time label is showing chrome.alarms.onAlarm.addListener(_onAlarm); const chromep = new ChromePromise(); chromep.alarms.get(_CLOCK_ALARM).then((alarm) =&gt; { if (!alarm) { chrome.alarms.create(_CLOCK_ALARM, { when: Date.now(), periodInMinutes: 1, }); } return null; }).catch((err) =&gt; { app.GA.error(err.message, 'chromep.alarms.get(CLOCK_ALARM)'); }); } } /** * Set the time label * @private * @memberOf app.ScreenSaver */ function _setTime() { const showTime = app.Storage.getInt('showTime', 0); if (showTime !== 0) { t.set('time', app.SSUtils.getTime()); } else { t.set('time', ''); } } /** * Mark a photo in [t.photos]{@link app.ScreenSaver.t.views} as unusable * @param {int} idx - index into [t.views]{@link app.ScreenSaver.t.views} * @private * @memberOf app.ScreenSaver */ function _markPhotoBad(idx) { const name = t.views[idx].getName(); const index = t.photos.findIndex((item) =&gt; { return item.name === name; }); if (index !== -1) { t.photos[index].name = 'skip'; const skipAll = t.photos.every((item) =&gt; { return item.name === 'skip'; }); if (skipAll) { // if all items are bad set no photos state app.SSUtils.setNoPhotos(t); } } } /** * Try to find a photo that has finished loading * @param {int} idx - index into [t.views]{@link app.ScreenSaver.t.views} * @returns {int} index into t.views, -1 if none are loaded * @memberOf app.ScreenSaver */ function _findLoadedPhoto(idx) { if (t.views[idx].isLoaded()) { return idx; } // wrap-around loop: https://stackoverflow.com/a/28430482/4468645 for (let i = 0; i &lt; t.views.length; i++) { const index = (i + idx) % t.views.length; const view = t.views[index]; if ((index === t.lastSelected) || (index === t.p.selected)) { // don't use current animation pair continue; } if (view.isLoaded()) { return index; } else if (view.isError()) { _markPhotoBad(index); } } return -1; } /** * Add the next photo from the master array * @param {int} idx - index into [t.views]{@link app.ScreenSaver.t.views} * @param {boolean} error - true if the photo at idx didn't load * @memberOf app.ScreenSaver */ function _replacePhoto(idx, error) { if (error) { // bad url, mark it _markPhotoBad(idx); } if (t.started &amp;&amp; (t.photos.length &gt; t.views.length)) { let item; for (let i = t.curIdx; i &lt; t.photos.length; i++) { // find a url that is ok, AFAWK item = t.photos[i]; if (item.name !== 'skip') { t.curIdx = i; break; } } // add the next image from the master list to this page t.views[idx].setPhoto(item); t.curIdx = (t.curIdx === t.photos.length - 1) ? 0 : t.curIdx + 1; } } /** * Replace the active photos with new photos from the master array * @memberOf app.ScreenSaver */ function _replaceAllPhotos() { if (t.photos.length &gt; t.views.length) { let pos = 0; let newIdx = t.curIdx; for (let i = t.curIdx; i &lt; t.photos.length; i++) { newIdx = i; const item = t.photos[i]; if (item.name !== 'skip') { if ((pos === t.lastSelected) || (pos === t.p.selected)) { // don't replace current animation pair continue; } // replace photo t.views[pos].setPhoto(item); pos++; if (pos === t.views.length) { break; } } } t.curIdx = (newIdx === t.photos.length - 1) ? 0 : newIdx + 1; } } /** * Get the next photo to display * @param {int} idx - index into [t.views]{@link app.ScreenSaver.t.views} * @returns {int} next - index into [t.views]{@link app.ScreenSaver.t.views} * to display, -1 if none are ready * @memberOf app.ScreenSaver */ function _getNextPhoto(idx) { let ret = _findLoadedPhoto(idx); if (ret === -1) { if (t.waitForLoad) { // no photos ready.. wait a little and try again the first time t.waitTime = 2000; t.waitForLoad = false; } else { // tried waiting for load, now replace the current photos t.waitTime = 200; _replaceAllPhotos(); idx = (idx === t.views.length - 1) ? 0 : idx + 1; ret = _findLoadedPhoto(idx); if (ret !== -1) { t.waitForLoad = true; } } } else if (t.waitTime !== t.transitionTime) { // photo found, set the waitTime back to transition time t.waitTime = t.transitionTime; } return ret; } /** * Called at fixed time intervals to cycle through the photos * Potentially runs forever * @memberOf app.ScreenSaver */ function _runShow() { if (t.noPhotos) { // no usable photos to show return; } const curPage = (t.p.selected === undefined) ? 0 : t.p.selected; const prevPage = (curPage &gt; 0) ? curPage - 1 : t.views.length - 1; let selected = (curPage === t.views.length - 1) ? 0 : curPage + 1; // for replacing the page in _onAniFinished t.replaceLast = t.lastSelected; t.prevPage = prevPage; if (t.p.selected === undefined) { // special case for first page. neon-animated-pages is configured // to run the entry animation for the first selection selected = curPage; } else if (!t.started) { // special case for first full animation. next time ready to start // splicing in the new images t.started = true; } selected = _getNextPhoto(selected); if (selected !== -1) { // If a new photo is ready, render it _setTime(); t.views[selected].render(); t.lastSelected = t.p.selected; // update t.p.selected so the animation runs t.p.selected = selected; } // setup the next timeout and call ourselves --- runs until interrupted window.setTimeout(() =&gt; { _runShow(); }, t.waitTime); } // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {app.Msg.Message} request - details for the message * @param {Object} [sender] - MessageSender object * @param {Function} [response] - function to call once after processing * @returns {boolean} true if asynchronous * @private * @memberOf app.ScreenSaver */ function _onMessage(request, sender, response) { if (request.message === app.Msg.SS_CLOSE.message) { app.SSUtils.close(); } else if(request.message === app.Msg.SS_IS_SHOWING.message) { // let people know we are here response({message: 'OK'}); } return false; } /** * Event: Listen for alarms * @param {Object} alarm - chrome alarm * @param {string} alarm.name - alarm type * @memberOf app.ScreenSaver */ function _onAlarm(alarm) { if (alarm.name === _CLOCK_ALARM) { // update time label if (t.p &amp;&amp; (t.p.selected !== undefined)) { _setTime(); } } } /** * Event listener for mouse clicks * Show link to original photo if possible and close windows */ window.addEventListener('click', function() { if (t.p &amp;&amp; (t.p.selected !== undefined)) { app.Photo.showSource(t.views[t.p.selected].photo); } app.SSUtils.close(); }, false); /** * Event listener for key press * Close window (prob won't work on Chrome OS) */ window.addEventListener('keydown', function() { app.SSUtils.close(); }, false); /** * Event listener for mouse move * Close window */ window.addEventListener('mousemove', function(event) { if (t.startMouse.x &amp;&amp; t.startMouse.y) { const deltaX = Math.abs(event.clientX - t.startMouse.x); const deltaY = Math.abs(event.clientY - t.startMouse.y); if (Math.max(deltaX, deltaY) &gt; 10) { // close after a minimum amount of mouse movement app.SSUtils.close(); } } else { // first move, set values t.startMouse.x = event.clientX; t.startMouse.y = event.clientY; } }, false); })(); Ã— Search results Close "},"background_ss_controller.js.html":{"id":"background_ss_controller.js.html","title":"Source: background/ss_controller.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: background/ss_controller.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Controller for the screen saver * @namespace */ app.SSControl = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); /** * Screensaver URL * @type {string} * @default * @const * @private * @memberOf app.SSControl */ const _SS_URL = '/html/screensaver.html'; /** * Determine if there is a full screen chrome window running on a display * @param {Object} display - a connected display * @returns {Promise&lt;boolean&gt;} true if there is a full screen * window on the display * @private * @memberOf app.SSControl */ function _hasFullscreen(display) { if (app.Storage.getBool('chromeFullscreen')) { return chromep.windows.getAll({populate: false}).then((wins) =&gt; { let ret = false; const left = display ? display.bounds.left : 0; const top = display ? display.bounds.top : 0; for (let i = 0; i &lt; wins.length; i++) { const win = wins[i]; if ((win.state === 'fullscreen') &amp;&amp; (!display || (win.top === top &amp;&amp; win.left === left))) { ret = true; break; } } return Promise.resolve(ret); }); } else { return Promise.resolve(false); } } /** * Determine if the screen saver is currently showing * @returns {Promise&lt;boolean&gt;} true if showing * @private * @memberOf app.SSControl */ function _isShowing() { // send message to the screensaver to see if he is around return app.Msg.send(app.Msg.SS_IS_SHOWING).then(() =&gt; { return Promise.resolve(true); }).catch(() =&gt; { // no one listening return Promise.resolve(false); }); } /** * Open a screen saver window on the given display * @param {Object} display - a connected display * @private * @memberOf app.SSControl */ function _open(display) { // window creation options const winOpts = { url: _SS_URL, focused: true, type: 'popup', }; _hasFullscreen(display).then((isTrue) =&gt; { if (isTrue) { // don't display if there is a fullscreen window return null; } if (app.Utils.getChromeVersion() &gt;= 44 &amp;&amp; !display) { // Chrome supports fullscreen option on create since version 44 winOpts.state = 'fullscreen'; } else { const left = display ? display.bounds.left : 0; const top = display ? display.bounds.top : 0; winOpts.left = left; winOpts.top = top; winOpts.width = 1; winOpts.height = 1; } return chromep.windows.create(winOpts); }).then((win) =&gt; { if (win &amp;&amp; (winOpts.state !== 'fullscreen')) { chrome.windows.update(win.id, {state: 'fullscreen'}); } return null; }).catch((err) =&gt; { app.GA.error(err.message, 'SSControl._open'); }); } /** * Open a screensaver on every display * @private * @memberOf app.SSControl */ function _openOnAllDisplays() { chromep.system.display.getInfo().then((displayArr) =&gt; { if (displayArr.length === 1) { _open(null); } else { displayArr.forEach((display) =&gt; { _open(display); }); } return Promise.resolve(); }).catch((err) =&gt; { app.GA.error(err.message, 'SSControl._openOnAllDisplays'); }); } /** * Event: Fired when the system changes to an active, idle or locked state. * The event fires with &quot;locked&quot; if the screen is locked or the screensaver * activates, &quot;idle&quot; if the system is unlocked and the user has not * generated any input for a specified number of seconds, and &quot;active&quot; * when the user generates input on an idle system. * @see https://developer.chrome.com/extensions/idle#event-onStateChanged * @param {string} state - current state of computer * @private * @memberOf app.SSControl */ function _onIdleStateChanged(state) { _isShowing().then((isTrue) =&gt; { if (state === 'idle' &amp;&amp; app.Alarm.isActive() &amp;&amp; !isTrue) { app.SSControl.display(false); } else { if (!app.Utils.isWin()) { // Windows 10 Creator triggers an 'active' state // when the window is created so we have to skip // closing here app.SSControl.close(); } } return null; }).catch((err) =&gt; { app.GA.error(err.message, 'SSControl._isShowing'); }); } // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {app.Msg.Message} request - details for the message * @param {Object} [sender] - MessageSender object * @param {Function} [response] - function to call once after processing * @returns {boolean} true if asynchronous * @private * @memberOf app.SSControl */ function _onChromeMessage(request, sender, response) { if (request.message === app.Msg.SS_SHOW.message) { // preview the screensaver app.SSControl.display(true); } return false; } // listen for changes to the idle state of the computer chrome.idle.onStateChanged.addListener(_onIdleStateChanged); // listen for chrome messages app.Msg.listen(_onChromeMessage); return { /** * Display the screen saver(s) * !Important: Always request screensaver through this call * @param {boolean} single - if true, only show on one display * @memberOf app.SSControl */ display: function(single) { if (!single &amp;&amp; app.Storage.getBool('allDisplays')) { _openOnAllDisplays(); } else { _open(null); } }, /** * Close all the screen saver windows * @memberOf app.SSControl */ close: function() { // send message to the screen savers to close themselves app.Msg.send(app.Msg.SS_CLOSE).catch(() =&gt; {}); }, }; })(); Ã— Search results Close "},"screensaver_ss_utils.js.html":{"id":"screensaver_ss_utils.js.html","title":"Source: screensaver/ss_utils.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: screensaver/ss_utils.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Utility methods for a screensaver * @namespace */ app.SSUtils = (function() { 'use strict'; new ExceptionHandler(); /** * Max number of animated pages * @type {int} * @const * @default * @private * @memberOf app.SSUtils */ const _MAX_PAGES = 20; return { /** * Set the state when no photos are available * @param {Object} t - screensaver template * @memberOf app.SSUtils */ setNoPhotos: function(t) { if (t &amp;&amp; t.$) { t.$.noPhotos.style.visibility = 'visible'; t.$.pages.style.visibility = 'hidden'; t.noPhotos = true; } }, /** * Set the window zoom factor to 1.0 * @memberOf app.SSUtils */ setZoom: function() { if (app.Utils.getChromeVersion() &gt;= 42) { // override zoom factor to 1.0 - chrome 42 and later const chromep = new ChromePromise(); chromep.tabs.getZoom().then((zoomFactor) =&gt; { if ((zoomFactor &lt;= 0.99) || (zoomFactor &gt;= 1.01)) { chrome.tabs.setZoom(1.0); } return null; }).catch((err) =&gt; { app.GA.error(err.message, 'chromep.tabs.getZoom'); }); } }, /** * Process settings related to a photo's appearance * @param {Object} t - screensaver template * @memberOf app.SSUtils */ setupPhotoSizing(t) { t.photoSizing = app.Storage.getInt('photoSizing', 0); if (t.photoSizing === 4) { // pick random sizing t.photoSizing = app.Utils.getRandomInt(0, 3); } switch (t.photoSizing) { case 0: t.sizingType = 'contain'; break; case 1: t.sizingType = 'cover'; break; case 2: case 3: t.sizingType = null; break; default: break; } }, /** * Build the Array of {@link app.Photo} objects that will be displayed * and the neon-animated-pages * @param {Object} t - screensaver template * @memberOf app.SSUtils */ loadPhotos: function(t) { // populate t.photos with selected photos let sources = app.PhotoSource.getSelectedPhotos(); sources = sources || []; sources.forEach((source) =&gt; { const type = source.type; let ct = 0; source.photos.forEach((sourcePhoto) =&gt; { if (!app.Photo.ignore(sourcePhoto.asp, t.photoSizing)) { const photo = new app.Photo('photo' + ct, sourcePhoto, type); t.photos.push(photo); ct++; } }); }); if (app.Storage.getBool('shuffle')) { // randomize the order app.Utils.shuffleArray(t.photos); } // create the animated pages const len = Math.min(t.photos.length, _MAX_PAGES); for (let i = 0; i &lt; len; i++) { const photo = t.photos[i]; const view = app.SSViewFull.createView(photo, t.photoSizing); t.push('views', view); t.curIdx++; } // force update of animated pages t.rep.render(); // set the Elements of the view t.views.forEach((view, index) =&gt; { const el = t.p.querySelector('#item' + index); const image = el.querySelector('.image'); const author = el.querySelector('.author'); const time = el.querySelector('.time'); const location = el.querySelector('.location'); const model = t.rep.modelForElement(el); view.setElements(image, author, time, location, model); }); if (!t.photos || (t.photos.length === 0)) { // No usable photos, display static image app.SSUtils.setNoPhotos(t); } }, /** * Get the current time as a string * @returns {string} time string suitable for display * @memberOf app.SSUtils */ getTime: function() { const format = app.Storage.getInt('showTime', 0); let timeString = ''; if (!Number.isNaN(format) &amp;&amp; (format &gt; 0)) { timeString = app.Time.getStringShort(); } return timeString; }, /** * Close ourselves * @memberOf app.SSUtils */ close: function() { // send message to other screen savers to close themselves app.Msg.send(app.Msg.SS_CLOSE).catch(() =&gt; {}); setTimeout(function() { // delay a little to process events window.close(); }, 750); }, }; })(); Ã— Search results Close "},"screensaver_views_ss_view.js.html":{"id":"screensaver_views_ss_view.js.html","title":"Source: screensaver/views/ss_view.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: screensaver/views/ss_view.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ (function() { window.app = window.app || {}; 'use strict'; new ExceptionHandler(); /** * Screensaver zoom view and base class for other SSView classes * @property {Element} image - paper-image * @property {Element} author - label * @property {Element} time - label * @property {Element} location - Geo location * @property {Object} model - template item model * @alias app.SSView */ app.SSView = class SSView { /** * Create a new SSView * @param {app.Photo} photo - photo item * @constructor */ constructor(photo) { this.photo = app.JSONUtils.shallowCopy(photo); this.image = null; this.author = null; this.time = null; this.location = null; this.model = null; } /** * Factory Method to create a new View * @param {app.Photo} photo - photo item * @param {int} sizing - photo sizing type * @returns {app.SSView} a new SSView or subclass * @static */ static createView(photo, sizing) { switch (sizing) { case 0: return new app.SSViewLetterbox(photo); case 1: return new app.SSView(photo); case 2: return new app.SSViewFrame(photo); case 3: return new app.SSViewFull(photo); default: app.GA.error(`Unknown SSView type: ${sizing}`, 'SSView.createView'); return new app.SSViewLetterbox(photo); } } /** * Should we show the location, if available * @returns {boolean} true if we should show the location * @static */ static _showLocation() { return app.Storage.getBool('showLocation'); } /** * Should we show the time * @returns {boolean} true if we should show the time * @static */ static showTime() { return app.Storage.getBool('showTime'); } /** * Does a photo have an author label to show * @returns {boolean} true if we should show the author */ _hasAuthor() { return !!this.photo.label; } /** * Does a photo have a geolocation * @returns {boolean} true if geolocation point is non-null */ _hasLocation() { return !!this.photo.point; } /** * Add superscript to the label for 500px photos * @private */ _super500px() { const type = this.photo.type; const authorText = this.photo.label; const sup = this.author.querySelector('#sup'); sup.textContent = ''; if (!app.Utils.isWhiteSpace(authorText) &amp;&amp; (type === '500')) { sup.textContent = 'px'; } } /** * Set the style for the time label */ _setTimeStyle() { if (app.Storage.getBool('largeTime')) { this.time.style.fontSize = '8.5vh'; this.time.style.fontWeight = 300; } } /** * Set the geolocation text */ _setLocation() { if (app.SSView._showLocation() &amp;&amp; this._hasLocation()) { app.Geo.get(this.photo.point).then((location) =&gt; { if (location &amp;&amp; this.model) { location = location.replace('Unnamed Road, ', ''); this.model.set('item.photo.location', location); } return Promise.resolve(); }).catch((err) =&gt; { const networkErr = app.Utils.localize('err_network'); if (!err.message.includes(networkErr)) { app.GA.error(err.message, 'SSView._setLocation'); } }); } } /** * Set the elements of the view * @param {Element} image - paper-image, photo * @param {Element} author - div, photographer * @param {Element} time - div, current time * @param {Element} location - div, geolocation text * @param {Object} model - template item model */ setElements(image, author, time, location, model) { this.image = image; this.author = author; this.time = time; this.location = location; this.model = model; this._setTimeStyle(); this._setLocation(); this._super500px(); } /** * Set the photo * @param {app.Photo} photo - a photo to render */ setPhoto(photo) { const photoCopy = app.JSONUtils.shallowCopy(photo); if (this.model) { this.model.set('item.photo', photoCopy); } this._setLocation(); this._super500px(); } /** * Get the name of the photo in this view * @returns {string} name of photo */ getName() { return this.photo.name; } /** * Render the page for display - the default CSS is for our view * subclasses override to determine the look of photo */ render() {} /** * Determine if a photo failed to load (usually 404 error) * @returns {boolean} true if image load failed */ isError() { return !this.image || this.image.error; } /** * Determine if a photo has finished loading * @returns {boolean} true if image is loaded */ isLoaded() { return !!this.image &amp;&amp; this.image.loaded; } }; })(); Ã— Search results Close "},"screensaver_views_ss_view_frame.js.html":{"id":"screensaver_views_ss_view_frame.js.html","title":"Source: screensaver/views/ss_view_frame.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: screensaver/views/ss_view_frame.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ (function() { window.app = window.app || {}; 'use strict'; new ExceptionHandler(); /** * Screensaver zoom view and base class for other SSView classes * @property {Element} image - paper-image * @property {Element} author - label * @property {Element} time - label * @property {Element} location - Geo location * @property {Object} model - template item model * @extends app.SSView * @alias app.SSViewFrame */ app.SSViewFrame = class extends app.SSView { /** * Create new SSViewFrame * @param {app.Photo} photo - photo item * @constructor */ constructor(photo) { super(photo); } /** * Set style info for a label * @param {Object} style - element.style object * @param {int} width - frame width * @param {int} height - frame height * @param {boolean} isLeft - if true align left, else right * @static * @private */ static _setLabelStyle(style, width, height, isLeft) { style.textOverflow = 'ellipsis'; style.whiteSpace = 'nowrap'; style.color = 'black'; style.opacity = 1.0; style.fontSize = '2.5vh'; style.fontWeight = 400; // percent of screen width for label padding let padPer = 0.5; // percent of screen width of image let imgWidthPer = (width / screen.width) * 100; // percent of screen width on each side of image let sidePer = (100 - imgWidthPer) / 2; if (isLeft) { style.left = sidePer + padPer + 'vw'; style.right = ''; style.textAlign = 'left'; } else { style.right = sidePer + padPer + 'vw'; style.left = ''; style.textAlign = 'right'; } style.width = imgWidthPer - 2 * padPer + 'vw'; // percent of screen height of image let imgHtPer = (height / screen.height) * 100; // percent of screen height on each side of image let topPer = (100 - imgHtPer) / 2; style.bottom = topPer + 1.1 + 'vh'; } /** * Render the page for display */ render() { super.render(); const model = this.model; const authorStyle = this.author.style; const locationStyle = this.location.style; const timeStyle = this.time.style; const image = this.image; const imageStyle = image.style; const img = image.$.img; const imgStyle = img.style; /** @type {app.Photo} */ const photo = this.photo; const ar = photo.aspectRatio; // scale to screen size const border = screen.height * 0.005; const borderBot = screen.height * 0.05; const padding = screen.height * 0.025; const label = app.Photo.buildAuthorLabel(photo.type, photo.author, true); model.set('item.label', label); const height = Math.min((screen.width - padding * 2 - border * 2) / ar, screen.height - padding * 2 - border - borderBot); const width = height * ar; // size with the frame const frWidth = width + border * 2; const frHeight = height + borderBot + border; imgStyle.height = height + 'px'; imgStyle.width = width + 'px'; image.height = height; image.width = width; imageStyle.top = (screen.height - frHeight) / 2 + 'px'; imageStyle.left = (screen.width - frWidth) / 2 + 'px'; imageStyle.border = 0.5 + 'vh ridge WhiteSmoke'; imageStyle.borderBottom = 5 + 'vh solid WhiteSmoke'; imageStyle.borderRadius = '1.5vh'; imageStyle.boxShadow = '1.5vh 1.5vh 1.5vh rgba(0,0,0,.7)'; app.SSViewFrame ._setLabelStyle(authorStyle, frWidth, frHeight, false); app.SSViewFrame ._setLabelStyle(locationStyle, frWidth, frHeight, true); // percent of screen height of image let imgHtPer = (frHeight / screen.height) * 100; // percent of screen height on each side of image let topPer = (100 - imgHtPer) / 2; // percent of screen width of image let imgWidthPer = (frWidth / screen.width) * 100; // percent of screen width on each side of image let sidePer = (100 - imgWidthPer) / 2; timeStyle.right = sidePer + 1.0 + 'vw'; timeStyle.textAlign = 'right'; timeStyle.bottom = topPer + 5.0 + 'vh'; // percent of half the width of image let maxWidth = imgWidthPer / 2; if (app.SSView._showLocation() &amp;&amp; this._hasLocation()) { // limit author width if we also have a location authorStyle.maxWidth = maxWidth - 1 + 'vw'; } if (this._hasAuthor()) { // limit location width if we also have an author locationStyle.maxWidth = maxWidth - 1 + 'vw'; } } }; })(); Ã— Search results Close "},"screensaver_views_ss_view_full.js.html":{"id":"screensaver_views_ss_view_full.js.html","title":"Source: screensaver/views/ss_view_full.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: screensaver/views/ss_view_full.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ (function() { window.app = window.app || {}; 'use strict'; new ExceptionHandler(); /** * Screensaver full view * @property {Element} image - paper-image * @property {Element} author - label * @property {Element} time - label * @property {Element} location - Geo location * @property {Object} model - template item model * @extends app.SSView * @alias app.SSViewFull */ app.SSViewFull = class extends app.SSView { /** * Create new SSViewFull * @param {app.Photo} photo - photo item * @constructor */ constructor(photo) { super(photo); } /** * Render the page for display */ render() { super.render(); const img = this.image.$.img; img.style.width = '100%'; img.style.height = '100%'; img.style.objectFit = 'fill'; } }; })(); Ã— Search results Close "},"screensaver_views_ss_view_letterbox.js.html":{"id":"screensaver_views_ss_view_letterbox.js.html","title":"Source: screensaver/views/ss_view_letterbox.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: screensaver/views/ss_view_letterbox.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ (function() { window.app = window.app || {}; 'use strict'; new ExceptionHandler(); /** * Aspect ratio of screen * @type {number} * @const * @private * @memberOf app.SSViewLetterbox */ const _SCREEN_AR = screen.width / screen.height; /** * Screensaver letterbox view * @property {Element} image - paper-image * @property {Element} author - label * @property {Element} time - label * @property {Element} location - Geo location * @property {Object} model - template item model * @extends app.SSView * @alias app.SSViewLetterbox */ app.SSViewLetterbox = class extends app.SSView { /** * Create new SSView * @param {app.Photo} photo - photo item * @constructor */ constructor(photo) { super(photo); } /** * Render the page for display */ render() { super.render(); const ar = this.photo.aspectRatio; const authorStyle = this.author.style; const locationStyle = this.location.style; const timeStyle = this.time.style; // percent of the screen width of image let imgWidthPer = ((ar / _SCREEN_AR * 100)); imgWidthPer = Math.min(imgWidthPer, 100.0); let right = (100 - imgWidthPer) / 2; // percent of the screen height of image let imgHeightPer = ((_SCREEN_AR / ar * 100)); imgHeightPer = Math.min(imgHeightPer, 100.0); let bottom = (100 - imgHeightPer) / 2; authorStyle.textAlign = 'right'; locationStyle.textAlign = 'left'; authorStyle.right = (right + 1) + 'vw'; authorStyle.bottom = (bottom + 1) + 'vh'; authorStyle.width = imgWidthPer - .5 + 'vw'; locationStyle.left = (right + 1) + 'vw'; locationStyle.bottom = (bottom + 1) + 'vh'; locationStyle.width = imgWidthPer - .5 + 'vw'; timeStyle.right = (right + 1) + 'vw'; timeStyle.bottom = (bottom + 3.5) + 'vh'; if (app.SSView.showTime()) { // don't wrap author authorStyle.textOverflow = 'ellipsis'; authorStyle.whiteSpace = 'nowrap'; } // percent of half the width of image let maxWidth = imgWidthPer / 2; if (app.SSView._showLocation() &amp;&amp; this._hasLocation()) { // limit author width if we also have a location authorStyle.maxWidth = maxWidth - 1.1 + 'vw'; } if (this._hasAuthor()) { // limit location width if we also have an author locationStyle.maxWidth = maxWidth - 1.1 + 'vw'; } } }; })(); Ã— Search results Close "},"storage.js.html":{"id":"storage.js.html","title":"Source: storage.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: storage.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Manage items in localStorage * @namespace */ app.Storage = (function() { 'use strict'; new ExceptionHandler(); return { /** * Get a JSON parsed value from localStorage * @param {!string} key - key to get value for * @returns {?JSON} JSON object, null if key does not exist * @memberOf app.Storage */ get: function(key) { let item = localStorage.getItem(key); let value = null; if (item !== null) { value = app.JSONUtils.parse(item); } return value; }, /** * Get integer value from localStorage * @param {!string} key - key to get value for * @param {?int} [def=null] - optional value to return, if NaN * @returns {int} value as integer, NaN on error * @memberOf app.Storage */ getInt: function(key, def = null) { let item = localStorage.getItem(key); let value = parseInt(item, 10); if (Number.isNaN(value)) { value = (def === null) ? value : def; if (def === null) { app.GA.error(`NaN value for: ${key}`, 'Storage.getInt'); } } return value; }, /** * Get boolean value from localStorage * @param {!string} key - key to get value for * @returns {?boolean} value as boolean, null if key does not exist * @memberOf app.Storage */ getBool: function(key) { return app.Storage.get(key); }, /** * JSON stringify and save a value to localStorage * @param {!string} key - key to set value for * @param {?Object} [value=null] - new value, if null remove item * @memberOf app.Storage */ set: function(key, value = null) { let val = value; if (value === null) { localStorage.removeItem(key); } else { val = JSON.stringify(value); localStorage.setItem(key, val); } }, /** * Save a value to localStorage only if there is enough room * @param {!string} key - localStorage Key * @param {Object} value - value to save * @param {string} [keyBool] - key to a boolean value * that is true if the primary key has non-empty value * @returns {boolean} true if value was set successfully * @memberOf app.Storage */ safeSet: function(key, value, keyBool) { let ret = true; const oldValue = app.Storage.get(key); try { app.Storage.set(key, value); } catch (e) { ret = false; if (oldValue) { // revert to old value app.Storage.set(key, oldValue); } if (keyBool) { // revert to old value if (oldValue &amp;&amp; oldValue.length) { app.Storage.set(keyBool, true); } else { app.Storage.set(keyBool, false); } } // notify listeners app.Msg.send(app.Msg.STORAGE_EXCEEDED).catch(() =&gt; {}); } return ret; }, }; })(); Ã— Search results Close "},"time.js.html":{"id":"time.js.html","title":"Source: time.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: time.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; (function() { 'use strict'; new ExceptionHandler(); /** * Time Class * @property {int} _hr - 24 hour time * @property {int} _min - minutes * @alias app.Time */ app.Time = class Time { /** * Create a new Time * @param {?string} [timeString=null] - in '00:00' format, if null * use current Date * @constructor */ constructor(timeString = null) { this._parse(timeString); } /** * Minutes in day * @returns {int} value */ static get MIN_IN_DAY() { return 60 * 24; } /** * Milliseconds in day * @returns {int} value */ static get MSEC_IN_DAY() { return app.Time.MIN_IN_DAY * 60 * 1000; } /** * Convert string to current time * @param {!string} timeString - in '00:00' format * @returns {int} time in milliSeconds from epoch */ static getTime(timeString) { const date = new Date(); const time = new Time(timeString); date.setHours(time._hr); date.setMinutes(time._min); date.setSeconds(0); date.setMilliseconds(0); return date.getTime(); } /** * Calculate time delta from now on a 24hr basis * @param {string} timeString - in '00:00' format * @returns {int} time delta in minutes */ static getTimeDelta(timeString) { const curTime = Date.now(); const time = app.Time.getTime(timeString); let delayMin = (time - curTime) / 1000 / 60; if (delayMin &lt; 0) { delayMin = app.Time.MIN_IN_DAY + delayMin; } return delayMin; } /** * Determine if current time is between start and stop, inclusive * @param {string} start - in '00:00' format * @param {string} stop - in '00:00' format * @returns {boolean} true if in the given range */ static isInRange(start, stop) { const curTime = Date.now(); const startTime = app.Time.getTime(start); const stopTime = app.Time.getTime(stop); let ret = false; if (start === stop) { ret = true; } else if (stopTime &gt; startTime) { if ((curTime &gt;= startTime) &amp;&amp; (curTime &lt;= stopTime)) { ret = true; } } else { if ((curTime &gt;= startTime) || (curTime &lt;= stopTime)) { ret = true; } } return ret; } /** * Get time as string suitable for display, including AM/PM if 12hr * @param {!string} timeString - in '00:00' format * @param {?int} [frmt=null] - optional format, overrides storage value * @returns {!string} display string * @static */ static getStringFull(timeString, frmt = null) { const time = new Time(timeString); return time.toString(frmt); } /** * Get current time suitable for display w/o AM/PM if 12hr * @returns {!string} display string * @static */ static getStringShort() { const time = new Time(); let timeString = time.toString(); // strip off AM/PM if (timeString.endsWith('M')) { // strip off AM/PM timeString = timeString.substring(0, timeString.length - 3); } return timeString; } /** * Determine if user wants 24 hr time * @param {?int} [frmt=null] - optional format, overrides storage value * @returns {boolean} true for 24 hour time * @static */ static is24Hr(frmt = null) { let ret = false; let format = app.Storage.getInt('showTime', 0); if (frmt !== null) { format = frmt; } const localeTime = app.Utils.localize('time_format'); if (format === 2) { // time display 24hr ret = true; } else if ((format === 0) &amp;&amp; (localeTime === '24')) { // time display off, locale time 24 ret = true; } return ret; } /** * Parse time string * @param {string} timeString - in '00:00' format * @private */ _parse(timeString) { if (timeString === null) { const date = new Date(); this._hr = date.getHours(); this._min = date.getMinutes(); } else { this._hr = parseInt(timeString.substr(0, 2), 10); this._min = parseInt(timeString.substr(3, 2), 10); } } /** * Get string representation of Time * @param {?int} [frmt=null] - optional format, overrides storage value * @returns {string} As string */ toString(frmt = null) { let ret; const date = new Date(); date.setHours(this._hr, this._min); if (Time.is24Hr(frmt)) { ret = date.toLocaleTimeString(navigator.language, { hour: 'numeric', minute: '2-digit', hour12: false, }); } else { ret = date.toLocaleTimeString('en-us', { hour: 'numeric', minute: '2-digit', hour12: true, }); } return ret; } }; })(); Ã— Search results Close "},"background_use500px.js.html":{"id":"background_use500px.js.html","title":"Source: background/use500px.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: background/use500px.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Interface to 500px API * @namespace */ app.Use500px = (function() { 'use strict'; new ExceptionHandler(); /** * 500px rest API * @type {string} * @const * @default * @private * @memberOf app.Use500px */ const _URL_BASE = 'https://api.500px.com/v1/'; /** * API authorization key * @type {string} * @const * @private * @memberOf app.Use500px */ const _KEY = 'iyKV6i6wu0R8QUea9mIXvEsQxIF0tMRVXopwYcFC'; /** * Max photos to return - 100 is API max * @type {int} * @const * @default * @private * @memberOf app.Use500px */ const _MAX_PHOTOS = 90; /** * Categories to use Make them an array to overcome 100 photo limit per call * @type {Array} * @const * @default * @private * @memberOf app.Use500px */ const _CATS = [ 'Nature,City and Architecture', 'Landscapes,Animals', 'Macro,Still Life,Underwater', ]; /** * Call API to get some photos * @param {string} url - server url * @returns {Promise&lt;app.PhotoSource.SourcePhoto[]&gt;} Array of photos * @private * @memberOf app.Use500px */ function _doGet(url) { return app.Http.doGet(url).then((response) =&gt; { if (response.error) { throw new Error(response.error); } const photos = []; response.photos.forEach((photo) =&gt; { if (!photo.nsfw) { const asp = photo.width / photo.height; let ex = null; let pt = null; if (photo.latitude &amp;&amp; photo.longitude) { pt = app.PhotoSource .getPt(photo.latitude, photo.longitude); ex = {}; } app.PhotoSource.addPhoto(photos, photo.images[0].url, photo.user.fullname, asp, ex, pt); } }); return Promise.resolve(photos); }); } return { /** * Retrieve the array of 500px photos * @param {string} type - name of 500px gallery * @returns {Promise&lt;app.PhotoSource.SourcePhoto[]&gt;} Array of photos * @memberOf app.Use500px */ loadPhotos: function(type) { // series of API calls const promises = []; _CATS.forEach((_CAT) =&gt; { let url = `${_URL_BASE}photos/?consumer_key=${_KEY}&amp;feature=${type}` + `&amp;only=${_CAT}&amp;rpp=${_MAX_PHOTOS}` + '&amp;sort=rating&amp;image_size=2048'; promises.push(_doGet(url)); }); // Collate the photos return Promise.all(promises).then((values) =&gt; { let photos = []; values.forEach((value) =&gt; { photos = photos.concat(value); }); return Promise.resolve(photos); }); }, }; })(); Ã— Search results Close "},"utils.js.html":{"id":"utils.js.html","title":"Source: utils.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: utils.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Utility methods * @namespace */ app.Utils = (function() { 'use strict'; new ExceptionHandler(); return { /** Get the extension's name * @returns {string} Extension name * @memberOf app.Utils */ getExtensionName: function() { return `chrome-extension://${chrome.runtime.id}`; }, /** * Get the Extension version * @returns {string} Extension version * @memberOf app.Utils */ getVersion: function() { const manifest = chrome.runtime.getManifest(); return manifest.version; }, /** * Get the Chrome version * @see http://stackoverflow.com/a/4900484/4468645 * @returns {int} Chrome major version * @memberOf app.Utils */ getChromeVersion: function() { const raw = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./); return raw ? parseInt(raw[2], 10) : false; }, /** * Get the full Chrome version * @see https://goo.gl/2ITMNO * @returns {string} Chrome version * @memberOf app.Utils */ getFullChromeVersion: function() { const raw = navigator.userAgent; return raw ? raw : 'Unknown'; }, /** * Get the i18n string * @param {string} messageName - key in messages.json * @returns {string} internationalized string * @memberOf app.Utils */ localize: function(messageName) { return chrome.i18n.getMessage(messageName); }, /** * Get the current locale * @returns {string} current locale e.g. en_US * @memberOf app.Utils */ getLocale: function() { return chrome.i18n.getMessage('@@ui_locale'); }, /** * Determine if a String is null or whitespace only * @param {?string} str - string to check * @returns {boolean} true is str is whitespace (or null) * @memberOf app.Utils */ isWhiteSpace: function(str) { return (!str || str.length === 0 || /^\\s*$/.test(str)); }, /** * true if we are MS windows * @returns {boolean} true if MS windows * @memberOf app.Utils */ isWin: function() { return app.Storage.get('os') === 'win'; }, /** * Returns a random integer between min and max inclusive * @param {int} min - min value * @param {int} max - max value * @returns {int} random int * @memberOf app.Utils */ getRandomInt: function(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }, /** * Randomly sort an Array in place * Fisher-Yates shuffle algorithm. * @param {Array} array - Array to sort * @memberOf app.Utils */ shuffleArray: function(array) { for (let i = array.length - 1; i &gt; 0; i--) { const j = Math.floor(Math.random() * (i + 1)); const temp = array[i]; array[i] = array[j]; array[j] = temp; } }, }; })(); Ã— Search results Close "},"exception_handler.js.html":{"id":"exception_handler.js.html","title":"Source: exception_handler.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Source: exception_handler.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ // noinspection ThisExpressionReferencesGlobalObjectJS (function(window, factory) { window.ExceptionHandler = factory(window); }(this, function(window) { 'use strict'; return ExceptionHandler; /** * Log Exceptions with analytics. Include: new ExceptionHandler()&lt;br /&gt; * at top of every js file * @constructor * @alias ExceptionHandler */ function ExceptionHandler() { if (typeof window.onerror === 'object') { // global error handler window.onerror = function(message, url, line, col, errObject) { if (app &amp;&amp; app.GA) { let msg = message; let stack = null; if (errObject &amp;&amp; errObject.message &amp;&amp; errObject.stack) { msg = errObject.message; stack = errObject.stack; } app.GA.exception(msg, stack); } }; } } })); Ã— Search results Close "},"global.html":{"id":"global.html","title":"Global","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Global Members PICASA :app.Permissions.Type Type: app.Permissions.Type Source: options/permissions.js, line 115 Type Definitions AppData Values for items in localStorage Type: Object Properties: Name Type Description version int version of data enabled boolean is screensaver enabled permPicasa string optional permission for Picasa idleTime UnitValue idle time to display screensaver transitionTime UnitValue time between photos skip boolean ignore extreme aspect ratio photos shuffle boolean randomize photo order photoSizing int photo display type photoTransition int transition animation showTime int time display format largeTime boolean display larger time label showPhotog boolean display name on own photos showLocation boolean display photo location background string background image keepAwake boolean manage computer poser settings chromeFullscreen boolean don't display over fullscreen allDisplays boolean show on all displays activeStart string Keep Wake start time '00:00' 24 hr activeStop string Keep Wake stop time '00:00' 24 hr allowSuspend boolean let computer sleep useSpaceReddit boolean use this photo source useEarthReddit boolean use this photo source useAnimalReddit boolean use this photo source useEditors500px boolean use this photo source usePopular500px boolean use this photo source useYesterday500px boolean use this photo source useInterestingFlickr boolean use this photo source useChromecast boolean use this photo source useAuthors boolean use this photo source useGoogle boolean use this photo source useSpaceReddit boolean use this photo source albumSelections Array Users Google Photos to use Source: background/data.js, line 38 GAEvent Google Analytics Event Type: Object Properties: Name Type Description eventCategory string category eventAction string action eventLabel string label noInteraction boolean direct user interaction? Source: analytics.js, line 26 UnitValue A number and associated units Type: Object Properties: Name Type Description base number value in base unit display number value in display unit unit int display unit Source: background/data.js, line 30 Ã— Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Classes Classes Photo PhotoSource SSView SSViewFrame SSViewFull SSViewLetterbox Time ExceptionHandler Namespaces Alarm Background ChromeCast Data Flickr GA Geo GooglePhotos Http JSONUtils Msg Options Permissions Reddit ScreenSaver SSControl SSUtils Storage Use500px Utils Ã— Search results Close "},"namespaces.list.html":{"id":"namespaces.list.html","title":"Namespaces","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespaces Classes Photo PhotoSource SSView SSViewFrame SSViewFull SSViewLetterbox Time ExceptionHandler Namespaces Alarm Background ChromeCast Data Flickr GA Geo GooglePhotos Http JSONUtils Msg Options Permissions Reddit ScreenSaver SSControl SSUtils Storage Use500px Utils Ã— Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Photo Screen Saver Chrome ExtensionThis extension displays a screensaver composed of a slide show of photos from multiple sources. Supported photo sources include: Your Google Photos - Note: Shared Albums are not supported Some background photos used by Chromecast Several streams from 500px Several sources from reddit Interesting photos from Flickr Note: Photos from the local file system are not supported. Many options are available to control the appearance of the slide show, including: Wait time after machine becomes idle to display screensaver Between photo time interval Photo display mode - (e.g., letterbox, fill screen) Photo transition animations - (e.g., fade, scale up) A scheduler to control when the screensaver, display, and computer should remain on Do not display over full screen Chrome windows (e.g., YouTube, Netflix) Show on all displays Display time Works great on all platforms but may be especially useful for your Chromebook. It is free and advertising free. It is implemented using Vanilla JavaScript and Polymer 1. View in Chrome Web Store GitHub Pages Ã— Search results Close "},"app.Alarm.html":{"id":"app.Alarm.html","title":"Namespace: Alarm","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: Alarm Alarm Manage alarms from the chrome.alarms API Source: background/alarm.js, line 14 See: https://developer.chrome.com/apps/alarms Members &lt;private, static, constant&gt; Alarms :Object Alarms triggered by chrome.alarms Type: Object Properties: Name Type Description ACTIVATE string screen saver is active DEACTIVATE string screen saver is not activate UPDATE_PHOTOS string photo sources should be updated BADGE_TEXT string icon's Badge text should be set Source: background/alarm.js, line 21 Methods &lt;private, static&gt; _onAlarm(alarm) Event: Fired when an alarm has elapsed. Parameters: Name Type Description alarm Object details on alarm Source: background/alarm.js, line 101 See: https://developer.chrome.com/apps/alarms#event-onAlarm &lt;private, static&gt; _setActiveState() Set state when the screensaver is in the active time range Source: background/alarm.js, line 44 &lt;private, static&gt; _setBadgeText() Set the Badge text on the icon Source: background/alarm.js, line 81 &lt;private, static&gt; _setInactiveState() Set state when the screensaver is in the inactive time range Source: background/alarm.js, line 66 &lt;static&gt; isActive() â†’ {boolean} Determine if the screen saver can be displayed Source: background/alarm.js, line 192 Returns: true, if can display Type boolean &lt;static&gt; updateBadgeText() Set the icon badge text Source: background/alarm.js, line 180 &lt;static&gt; updateRepeatingAlarms() Set the repeating alarms states Source: background/alarm.js, line 132 Ã— Search results Close "},"app.Background.html":{"id":"app.Background.html","title":"Namespace: Background","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: Background Background The background script for the extension. Source: background/background.js, line 10 Methods &lt;private, static&gt; _onChromeMessage(request [, sender] [, response]) â†’ {boolean} Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Argument Description request app.Msg.Message details for the message sender Object &lt;optional&gt; MessageSender object response function &lt;optional&gt; function to call once after processing Source: background/background.js, line 161 See: https://developer.chrome.com/extensions/runtime#event-onMessage Returns: true if asynchronous Type boolean &lt;private, static&gt; _onIconClicked() Event: Fired when a browser action icon is clicked. Source: background/background.js, line 103 See: https://goo.gl/abVwKu &lt;private, static&gt; _onInstalled(details) Event: Fired when the extension is first installed, when the extension is updated to a new version, and when Chrome is updated to a new version. Parameters: Name Type Description details Object type of event Source: background/background.js, line 50 See: https://developer.chrome.com/extensions/runtime#event-onInstalled &lt;private, static&gt; _onKeyCommand(cmd) Event: Fired when a registered command is activated using a keyboard shortcut. Parameters: Name Type Description cmd string keyboard command Source: background/background.js, line 143 See: https://developer.chrome.com/extensions/commands#event-onCommand &lt;private, static&gt; _onMenuClicked(info) Event: Fired when a context menu item is clicked. Parameters: Name Type Description info Object info. on the clicked menu Properties Name Type Description menuItemId Object menu name Source: background/background.js, line 127 See: https://developer.chrome.com/extensions/contextMenus#event-onClicked &lt;private, static&gt; _onStartup() Event: Fired when a profile that has this extension installed first starts up Source: background/background.js, line 92 See: https://developer.chrome.com/extensions/runtime#event-onStartup &lt;private, static&gt; _onStorageChanged(event) Event: Fired when item in localStorage changes Parameters: Name Type Description event Event StorageEvent Properties Name Type Description key string storage item that changed Source: background/background.js, line 115 See: https://developer.mozilla.org/en-US/docs/Web/Events/storage &lt;private, static&gt; _showOptionsTab() Display the options tab Source: background/background.js, line 22 &lt;private, static&gt; _toggleEnabled() Toggle enabled state of the screen saver Source: background/background.js, line 35 Ã— Search results Close "},"app.ChromeCast.html":{"id":"app.ChromeCast.html","title":"Namespace: ChromeCast","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: ChromeCast ChromeCast Interface to the Chromecast photos Source: background/chromecast.js, line 13 Methods &lt;static&gt; loadPhotos() â†’ {Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt;} Get the photos from chromecast.json Source: background/chromecast.js, line 24 Returns: Array of photos Type Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt; Ã— Search results Close "},"app.Data.html":{"id":"app.Data.html","title":"Namespace: Data","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: Data Data Manage the extensions data Source: background/data.js, line 13 Members &lt;private, static, constant&gt; _DATA_VERSION :int Version of localStorage - update when items are added, removed, changed Type: int Default Value: 12 Source: background/data.js, line 28 &lt;private, static, constant&gt; _DEF_VALUES :AppData Default values in localStorage Type: AppData Source: background/data.js, line 82 Methods &lt;private, static&gt; _addDefaults() Save the _DEF_VALUES items, if they do not already exist Source: background/data.js, line 190 &lt;private, static&gt; _convertSliderValue(key) Convert a setting-slider value due to addition of units Parameters: Name Type Description key string localStorage key Source: background/data.js, line 204 &lt;private, static&gt; _getTimeFormat() â†’ {int} Get default time format based on locale Source: background/data.js, line 162 Returns: 12 or 24 Type int &lt;private, static&gt; _processEnabled() Set state based on screensaver enabled flag Note: this does not effect the keep awake settings so you could use the extension as a display keep awake scheduler without using the screensaver Source: background/data.js, line 124 &lt;private, static&gt; _processIdleTime() Set wait time for screen saver display after machine is idle Source: background/data.js, line 152 &lt;private, static&gt; _processKeepAwake() Set power scheduling features Source: background/data.js, line 139 &lt;private, static&gt; _setOS() â†’ {Promise} Set the 'os' value Source: background/data.js, line 177 Returns: err on failure Type Promise &lt;static&gt; initialize() Initialize the data saved in localStorage Source: background/data.js, line 221 &lt;static&gt; processState( [key]) Process changes to localStorage items Parameters: Name Type Argument Default Description key string &lt;optional&gt; 'all' the item that changed Source: background/data.js, line 301 &lt;static&gt; restoreDefaults() Restore default values for data saved in localStorage Source: background/data.js, line 280 &lt;static&gt; update() Update the data saved in localStorage Source: background/data.js, line 238 Ã— Search results Close "},"app.Flickr.html":{"id":"app.Flickr.html","title":"Namespace: Flickr","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: Flickr Flickr Interface to flickr API Source: background/flickr.js, line 13 Members &lt;private, static, constant&gt; _KEY :string Flickr rest API authorization key Type: string Source: background/flickr.js, line 35 &lt;private, static, constant&gt; _MAX_PHOTOS :int Max photos to return Type: int Default Value: 250 Source: background/flickr.js, line 45 &lt;private, static, constant&gt; _URL_BASE :string Flickr rest API Type: string Default Value: https://api.flickr.com/services/rest/ Source: background/flickr.js, line 26 Methods &lt;private, static&gt; _processPhotos(response) â†’ {Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt;} Extract the photos into an Array Parameters: Name Type Description response JSON server response Source: background/flickr.js, line 54 Returns: Array of photos Type Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt; &lt;static&gt; loadAuthorPhotos() â†’ {Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt;} Get my photo album Source: background/flickr.js, line 86 Returns: Array of photos Type Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt; &lt;static&gt; loadPhotos() â†’ {Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt;} Retrieve flickr photos Source: background/flickr.js, line 106 Returns: Array of photos Type Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt; Ã— Search results Close "},"app.GA.html":{"id":"app.GA.html","title":"Namespace: GA","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: GA GA Manage Google Analytics tracking Source: analytics.js, line 13 Members &lt;static, constant&gt; EVENT :Object Event types Type: Object Properties: Name Type Description INSTALLED GAEvent extension installed MENU GAEvent menu selected TOGGLE GAEvent setting-toggle LINK GAEvent setting-link BUTTON GAEvent button click Source: analytics.js, line 46 &lt;private, static, constant&gt; TRACKING_ID :string Tracking ID Type: string Default Value: UA-61314754-1 Source: analytics.js, line 24 Methods &lt;private, static&gt; _onLoad() Event: called when document and resources are loaded Initialize Google Analytics Source: analytics.js, line 85 &lt;static&gt; error( [label] [, action]) Send an error Parameters: Name Type Argument Default Description label string &lt;optional&gt; &lt;nullable&gt; null override label action string &lt;optional&gt; &lt;nullable&gt; null override action Source: analytics.js, line 151 &lt;static&gt; event(event [, label] [, action]) Send an event Parameters: Name Type Argument Default Description event GAEvent the event type label string &lt;optional&gt; &lt;nullable&gt; null override label action string &lt;optional&gt; &lt;nullable&gt; null override action Source: analytics.js, line 135 &lt;static&gt; exception(message [, stack] [, fatal]) Send an exception Parameters: Name Type Argument Default Description message string the error message stack string &lt;optional&gt; &lt;nullable&gt; null error stack fatal boolean &lt;optional&gt; null true if fatal Source: analytics.js, line 171 &lt;static&gt; page(page) Send a page Parameters: Name Type Description page string page path Source: analytics.js, line 122 Ã— Search results Close "},"app.Geo.html":{"id":"app.Geo.html","title":"Namespace: Geo","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: Geo Geo Handle interaction the Google maps geocode API Source: screensaver/geo.js, line 13 Members &lt;private, static, constant&gt; _GEOCODE_API :string Path to Google's geocode api Type: string Default Value: http://maps.googleapis.com/maps/api/geocode/json Source: screensaver/geo.js, line 26 &lt;private, static, constant&gt; _LOC_CACHE :app.Geo.Cache Location cache Type: app.Geo.Cache Source: screensaver/geo.js, line 51 Methods &lt;private, static&gt; _addToCache(point, location) Try to get (@link app.Geo.Location} from cache Parameters: Name Type Description point string a geolocation location string description Source: screensaver/geo.js, line 76 &lt;private, static&gt; _getFromCache(point) â†’ {app.Geo.Location|undefined} Try to get (@link app.Geo.Location} from cache Parameters: Name Type Description point string a geolocation Source: screensaver/geo.js, line 63 Returns: location, undefined if not cached Type app.Geo.Location | undefined &lt;static&gt; get(point) â†’ {Promise.&lt;string&gt;} Get the location string Parameters: Name Type Description point string 'lat,long' Source: screensaver/geo.js, line 94 Returns: geolocation as string Type Promise.&lt;string&gt; Type Definitions Cache Cache of Geo Locations Type: Object Properties: Name Type Description entries Array.&lt;app.Geo.Location&gt; Array of locations maxSize int max entries to cache Source: screensaver/geo.js, line 37 Location A Geo location Type: Object Properties: Name Type Description loc string descriptive location point string geo location 'lat lon' Source: screensaver/geo.js, line 29 Ã— Search results Close "},"app.GooglePhotos.html":{"id":"app.GooglePhotos.html","title":"Namespace: GooglePhotos","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: GooglePhotos GooglePhotos Interface to Picasa API Source: google_photos.js, line 13 Members &lt;private, static, constant&gt; _ALBUM_QUERY :string Query an album Type: string Source: google_photos.js, line 69 &lt;private, static, constant&gt; _ALBUMS_QUERY :string Query for list of albums Type: string Source: google_photos.js, line 58 &lt;private, static, constant&gt; _URL_BASE :string Path to Picasa API Type: string Default Value: https://picasaweb.google.com/data/feed/api/user/ Source: google_photos.js, line 48 Methods &lt;private, static&gt; _getThumbnail(entry) â†’ {string} Get the thumbnail url if it exists Parameters: Name Type Description entry Array Picasa media object Source: google_photos.js, line 109 Returns: url or null Type string &lt;private, static&gt; _hasGeo(entry) â†’ {boolean} Determine if a Picasa entry has Geo position Parameters: Name Type Description entry Object Picasa media object Source: google_photos.js, line 96 Returns: true if entry has Geo position Type boolean &lt;private, static&gt; _isImage(entry) â†’ {boolean} Determine if a Picasa entry is an image Parameters: Name Type Description entry Object Picasa media object Source: google_photos.js, line 80 Returns: true if entry is a photo Type boolean &lt;private, static&gt; _loadPicasaAlbum(albumId [, userId]) â†’ {Promise.&lt;Object&gt;} Retrieve a Google Photos album Parameters: Name Type Argument Default Description albumId string Picasa album ID userId string &lt;optional&gt; 'default' userId for non-authenticated request Source: google_photos.js, line 158 Returns: Root object from Picasa call null if not found Type Promise.&lt;Object&gt; &lt;private, static&gt; _processPhotos(root) â†’ {Array.&lt;app.PhotoSource.SourcePhoto&gt;} Extract the Picasa photos into an Array Parameters: Name Type Description root Object root object from Picasa API call Source: google_photos.js, line 126 Returns: Array of photos Type Array.&lt;app.PhotoSource.SourcePhoto&gt; &lt;static&gt; loadAlbumList(interactive) â†’ {Promise.&lt;Array.&lt;app.GooglePhotos.Album&gt;&gt;} Retrieve the users list of albums, including the photos in each Parameters: Name Type Description interactive boolean true is user initiated call Source: google_photos.js, line 182 Returns: Array of albums Type Promise.&lt;Array.&lt;app.GooglePhotos.Album&gt;&gt; &lt;static&gt; loadPhotos() â†’ {Promise.&lt;Array.&lt;app.GooglePhotos.SelectedAlbum&gt;&gt;} Retrieve the photos in the selected albums Source: google_photos.js, line 243 Returns: Array albums Type Promise.&lt;Array.&lt;app.GooglePhotos.SelectedAlbum&gt;&gt; Type Definitions Album A Google Photo Album Type: Object Properties: Name Type Description index int Array index uid string unique identifier name string album name id string Google album Id thumb string thumbnail url checked boolean is album selected ct int number of photos photos Array.&lt;app.PhotoSource.SourcePhoto&gt; Array of photos Source: google_photos.js, line 18 SelectedAlbum A Selected Google Photo Album Type: Object Properties: Name Type Description id string Google album Id photos Array.&lt;app.PhotoSource.SourcePhoto&gt; Array of photos Source: google_photos.js, line 32 Ã— Search results Close "},"app.Http.html":{"id":"app.Http.html","title":"Namespace: Http","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: Http Http Fetch with authentication and exponential back-off Source: http.js, line 13 Members &lt;private, static, constant&gt; _AUTH_HEADER Authorization header Default Value: Authorization Source: http.js, line 27 &lt;private, static, constant&gt; _BEARER Bearer parameter for authorized call Default Value: Bearer Source: http.js, line 36 &lt;private, static, constant&gt; _DELAY Delay multiplier for exponential back-off Default Value: 1000 Source: http.js, line 54 &lt;private, static, constant&gt; _MAX_RETRIES Max retries on 500 errors Default Value: 3 Source: http.js, line 45 Methods &lt;private, static&gt; _fetch(url, opts, isAuth, retryToken, interactive, attempt, backoff, maxRetries) â†’ {Promise.&lt;JSON&gt;} Perform fetch, optionally using authorization and exponential back-off Parameters: Name Type Description url string server request opts Object fetch options isAuth boolean if true, authorization required retryToken boolean if true, retry with new token interactive boolean if true, user initiated attempt int the retry attempt we are on backoff boolean if true, do exponential back-off maxRetries int max retries on 500 failures Source: http.js, line 226 Returns: response from server Type Promise.&lt;JSON&gt; &lt;private, static&gt; _getAuthToken(isAuth, interactive) â†’ {Promise.&lt;string&gt;} Get authorization token Parameters: Name Type Description isAuth boolean if true, authorization required interactive boolean if true, user initiated Source: http.js, line 135 Returns: auth token Type Promise.&lt;string&gt; &lt;private, static&gt; _getError(response) â†’ {Error} Get Error message Parameters: Name Type Description response Object server response Source: http.js, line 116 Returns: details on failure Type Error &lt;private, static&gt; _processResponse(response, url, opts, isAuth, retryToken, token, interactive, attempt, backoff, maxRetries) â†’ {Promise.&lt;JSON&gt;} Check response and act accordingly Parameters: Name Type Description response Object response from server url string server opts Object fetch options isAuth boolean true is authorization required retryToken boolean if true, retry with new token token string cached auth token interactive boolean true if user initiated attempt int the retry attempt we are on backoff boolean if true, do exponential back-off maxRetries int max retries Source: http.js, line 72 Returns: response from server Type Promise.&lt;JSON&gt; &lt;private, static&gt; _retry(url, opts, isAuth, retryToken, interactive, attempt, maxRetries) â†’ {Promise.&lt;JSON&gt;} Retry authorized fetch with exponential back-off Parameters: Name Type Description url string server request opts Object fetch options isAuth boolean if true, authorization required retryToken boolean if true, retry with new token interactive boolean true if user initiated attempt int the retry attempt we are on maxRetries int max retries Source: http.js, line 175 Returns: response from server Type Promise.&lt;JSON&gt; &lt;private, static&gt; _retryToken(url, opts, token, interactive, attempt, backoff, maxRetries) â†’ {Promise.&lt;JSON&gt;} Retry fetch after removing cached auth token Parameters: Name Type Description url string server request opts Object fetch options token string cached auth token interactive boolean true if user initiated attempt int the retry attempt we are on backoff boolean if true, do exponential back-off maxRetries int max retries Source: http.js, line 201 Returns: response from server Type Promise.&lt;JSON&gt; &lt;static&gt; doGet(url [, isAuth] [, retryToken] [, interactive] [, backoff] [, maxRetries]) â†’ {Promise.&lt;json&gt;} Perform GET request to server, optionally using exponential back-off and authorization Parameters: Name Type Argument Default Description url string server request isAuth boolean &lt;optional&gt; false if true, authorization required retryToken boolean &lt;optional&gt; false if true, retry with new token interactive boolean &lt;optional&gt; false user initiated, if true backoff boolean &lt;optional&gt; true if true, do exponential back-off maxRetries int &lt;optional&gt; _MAX_ATTEMPTS max retries Source: http.js, line 260 Returns: response from server Type Promise.&lt;json&gt; Ã— Search results Close "},"app.JSONUtils.html":{"id":"app.JSONUtils.html","title":"Namespace: JSONUtils","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: JSONUtils JSONUtils JSON utilities Source: json.js, line 13 Methods &lt;static&gt; parse(jsonString) â†’ {JSON} Parse JSON, with exception handling Parameters: Name Type Description jsonString string string to parse Source: json.js, line 25 Returns: JSON Object, null on error Type JSON &lt;static&gt; shallowCopy(object) â†’ {JSON} Return shallow copy of Object Parameters: Name Type Description object Object object to copy Source: json.js, line 42 Returns: JSON Object, null on error Type JSON Ã— Search results Close "},"app.Msg.html":{"id":"app.Msg.html","title":"Namespace: Msg","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: Msg Msg Wrapper for chrome messages Source: msg.js, line 13 Members &lt;static, constant&gt; HIGHLIGHT :app.Msg.Message Highlight a tab Type: app.Msg.Message Source: msg.js, line 69 &lt;static, constant&gt; PHOTO_SOURCE_FAILED :app.Msg.Message An app.PhotoSource server request failed Type: app.Msg.Message Source: msg.js, line 87 &lt;static, constant&gt; RESTORE_DEFAULTS :app.Msg.Message Restore default settings Type: app.Msg.Message Source: msg.js, line 60 &lt;static, constant&gt; SS_CLOSE :app.Msg.Message Close app.ScreenSaver Type: app.Msg.Message Source: msg.js, line 42 &lt;static, constant&gt; SS_IS_SHOWING :app.Msg.Message Is a app.ScreenSaver showing Type: app.Msg.Message Source: msg.js, line 51 &lt;static, constant&gt; SS_SHOW :app.Msg.Message Show app.ScreenSaver Type: app.Msg.Message Source: msg.js, line 33 &lt;static, constant&gt; STORAGE_EXCEEDED :app.Msg.Message A save attempt to localStorage exceeded its capacity Type: app.Msg.Message Source: msg.js, line 78 &lt;static, constant&gt; STORE :app.Msg.Message Save value to storage message Type: app.Msg.Message Source: msg.js, line 98 Methods &lt;static&gt; listen(listener) Add a listener for chrome messages Parameters: Name Type Description listener function function to receive messages Source: msg.js, line 140 &lt;static&gt; send(type) â†’ {Promise.&lt;JSON&gt;} Send a chrome message Parameters: Name Type Description type app.Msg.Message type of message Source: msg.js, line 120 Returns: response JSON Type Promise.&lt;JSON&gt; Type Definitions Message A Chrome message Type: Object Properties: Name Type Argument Description message string Unique name error Error an error key string key name value Object &lt;nullable&gt; value of key Source: msg.js, line 18 Ã— Search results Close "},"app.Options.html":{"id":"app.Options.html","title":"Namespace: Options","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: Options Options Extension's Options page Source: options/options.js, line 10 Members &lt;private, static, constant&gt; EXT_URI :string Path to the extension in the Web Store Type: string Source: options/options.js, line 37 &lt;private, static, constant&gt; PUSHY_URI :string Path to my Pushy Clipboard extension Type: string Source: options/options.js, line 49 &lt;private, static, constant&gt; t :Object auto-binding template Type: Object Source: options/options.js, line 60 &lt;static&gt; t.pages :Array.&lt;Options.Page&gt; Array of pages Type: Array.&lt;Options.Page&gt; Source: options/options.js, line 67 &lt;static&gt; t.route :string Current Options.Page Type: string Source: options/options.js, line 113 Methods &lt;private, static&gt; _onMessage(request [, sender] [, response]) â†’ {boolean} Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Argument Description request app.Msg.Message details for the message sender Object &lt;optional&gt; MessageSender object response function &lt;optional&gt; function to call once after processing Source: options/options.js, line 250 See: https://developer.chrome.com/extensions/runtime#event-onMessage Returns: true if asynchronous Type boolean &lt;static&gt; _scrollPageToTop() Scroll page to top Source: options/options.js, line 234 &lt;static&gt; _showGooglePhotosPage(index) Show the Google Photos page Parameters: Name Type Description index int index into t.pages Source: options/options.js, line 184 &lt;private, static&gt; _showHelpPage(index) Show the help page Parameters: Name Type Description index int index into t.pages Source: options/options.js, line 204 &lt;static&gt; _showScreensaverPreview(index, prevRoute) Display a preview of the screen saver Parameters: Name Type Description index int index into t.pages prevRoute string last page selected Source: options/options.js, line 222 &lt;static&gt; t._computeMenu() â†’ {string} Computed property: Menu label Source: options/options.js, line 175 Returns: i18n label Type string &lt;static&gt; t._computeTitle() â†’ {string} Computed property: Page title Source: options/options.js, line 166 Returns: i18n title Type string &lt;static&gt; t._onNavMenuItemTapped(event) Event: navigation menu selected Route to proper page Parameters: Name Type Description event Event ClickEvent Source: options/options.js, line 132 Ã— Search results Close "},"app.Permissions.html":{"id":"app.Permissions.html","title":"Namespace: Permissions","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: Permissions Permissions Handle optional permissions Source: options/permissions.js, line 13 Members &lt;private, static, constant&gt; _STATE :app.Permissions.State Possible states of an app.Permissions.Type Type: app.Permissions.State Source: options/permissions.js, line 45 &lt;static, constant&gt; PICASA :app.Permissions.Type Permission for access to users' Google Photos Type: app.Permissions.Type Source: options/permissions.js, line 57 Methods &lt;static&gt; _contains(type) â†’ {Promise.&lt;boolean&gt;} Determine if we have the optional permissions Parameters: Name Type Description type app.Permissions.Type permission type Source: options/permissions.js, line 85 Returns: true if we have permissions Type Promise.&lt;boolean&gt; &lt;private, static&gt; _remove(type) â†’ {Promise.&lt;boolean&gt;} Remove the optional permissions Parameters: Name Type Description type app.Permissions.Type permission type Source: options/permissions.js, line 99 Returns: true if removed Type Promise.&lt;boolean&gt; &lt;private, static&gt; _setState(type, value) Persist the state of an app.Permissions.Type Parameters: Name Type Description type app.Permissions.Type permission type value string permission state Source: options/permissions.js, line 70 &lt;static&gt; isAllowed(type) â†’ {boolean} Has the user allowed the optional permissions Parameters: Name Type Description type app.Permissions.Type permission type Source: options/permissions.js, line 133 Returns: true if allowed Type boolean &lt;static&gt; notSet(type) â†’ {boolean} Has user made choice on permissions Parameters: Name Type Description type app.Permissions.Type permission type Source: options/permissions.js, line 123 Returns: true if allowed or denied Type boolean &lt;static&gt; request(type) â†’ {Promise.&lt;boolean&gt;} Request optional permission - may block Parameters: Name Type Description type app.Permissions.Type permission type Source: options/permissions.js, line 143 Returns: true if permission granted Type Promise.&lt;boolean&gt; Type Definitions State A permission state enum Type: Object Properties: Name Type Description notSet string never been allowed or denied allowed string user allowed denied string user denied Source: options/permissions.js, line 20 Type A permission type Type: Object Properties: Name Type Description name string name in localStorage permissions Array.&lt;string&gt; array of permissions origins Array.&lt;string&gt; array of origins Source: options/permissions.js, line 29 Ã— Search results Close "},"app.Photo.html":{"id":"app.Photo.html","title":"Class: Photo","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Class: Photo Photo new Photo(name, source, sourceType) A photo for the screen saver Important: Only implement static methods. This Object will be shallow copied in the screensaver and lose its instance methods Parameters: Name Type Description name string unique name source app.PhotoSource.SourcePhoto source photo sourceType string type of app.PhotoSource Properties: Name Type Argument Description name string Unique name path string The url to the photo author string The photographer type string type of app.PhotoSource width int width height int height aspectRatio number aspect ratio ex Object additional information about the photo point string geolocation 'lat lon' label string author label location string &lt;nullable&gt; geolocation label Source: screensaver/photo.js, line 43 Members &lt;private, static, constant&gt; _SCREEN_ASP :number aspect ratio of screen Type: number Source: screensaver/photo.js, line 19 Methods &lt;private, static&gt; _isBadAspect(asp) â†’ {boolean} Determine if a photo would look bad zoomed or stretched on the screen Parameters: Name Type Description asp number aspect ratio of photo Source: screensaver/photo.js, line 98 Returns: true if a photo aspect ratio differs substantially from the screens' Type boolean &lt;static&gt; buildAuthorLabel(type, author, force) â†’ {string} Create the author label Parameters: Name Type Description type string source of photo author string author of photo force boolean require display of label if true Source: screensaver/photo.js, line 67 Returns: label describing the photo source and photographer name Type string &lt;static&gt; ignore(asp, photoSizing) â†’ {boolean} Determine if a photo should not be displayed Parameters: Name Type Description asp number aspect ratio photoSizing int the sizing type Source: screensaver/photo.js, line 110 Returns: true if the photo should not be displayed Type boolean &lt;static&gt; showSource(item) Create a new tab with a link to the original source of the current photo, if possible Parameters: Name Type Description item Object a photo item Source: screensaver/photo.js, line 129 Ã— Search results Close "},"app.PhotoSource.html":{"id":"app.PhotoSource.html","title":"Class: PhotoSource","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Class: PhotoSource PhotoSource new PhotoSource(useName, photosName, type, isDaily, isArray, loadObj, loadFn, loadArgs) A potential source of photos for the screensaver Parameters: Name Type Description useName string The key for if the source is selected photosName string The key for the collection of photos type string A descriptor of the photo source isDaily boolean Should the source be updated daily isArray boolean Is the source an Array of photo Arrays loadObj string function wrapper, as a string loadFn string function to load photos, as a string loadArgs Array Arguments to the loadFn Source: photo_sources.js, line 26 Members &lt;private, static&gt; _SRCS :Array.&lt;app.PhotoSource&gt; Array of PhotoSources Type: Array.&lt;app.PhotoSource&gt; Source: photo_sources.js, line 66 Methods &lt;static&gt; addPhoto(photos, url, author, asp [, ex] [, point]) Add a app.PhotoSource.SourcePhoto to an existing Array Parameters: Name Type Argument Description photos Array app.PhotoSource.SourcePhoto Array url string The url to the photo author string The photographer asp number The aspect ratio of the photo ex Object &lt;optional&gt; Additional information about the photo point string &lt;optional&gt; 'lat lon' Source: photo_sources.js, line 282 &lt;static&gt; contains(useName) â†’ {boolean} Determine if a given string is a photo source Parameters: Name Type Description useName string String to check Source: photo_sources.js, line 211 Returns: true if photo source Type boolean &lt;static&gt; getPt(lat, lon) â†’ {string} Get a geo point string from a latitude and longitude Parameters: Name Type Description lat number latitude lon number longitude Source: photo_sources.js, line 265 Returns: 'lat lon' Type string &lt;static&gt; getSelectedPhotos() â†’ {Array.&lt;app.PhotoSource.SourcePhotos&gt;} Get all the photos from all selected sources. These will be used by the screensaver. Source: photo_sources.js, line 198 Returns: Array of sources photos Type Array.&lt;app.PhotoSource.SourcePhotos&gt; &lt;static&gt; getUseNames() â†’ {Array.&lt;string&gt;} Get all the keys of useage boolean variables Source: photo_sources.js, line 185 Returns: Array of keys of useage boolean variables Type Array.&lt;string&gt; &lt;static&gt; process(useName) â†’ {Promise.&lt;void&gt;} Process the given photo source and save to localStorage. This normally requires a https call and may fail for various reasons Parameters: Name Type Description useName string The photo source to retrieve Source: photo_sources.js, line 226 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; processAll() Process all the selected photo sources. This normally requires a https call and may fail for various reasons Source: photo_sources.js, line 240 &lt;static&gt; processDaily() Process all the selected photo sources that are to be updated every day. This normally requires a https call and may fail for various reasons Source: photo_sources.js, line 251 &lt;private&gt; _getPhotos() â†’ {app.PhotoSource.SourcePhotos} Get the photos from local storage Source: photo_sources.js, line 157 Returns: the photos Type app.PhotoSource.SourcePhotos &lt;private&gt; _savePhotos(photos) â†’ {string} Save the photos to localStorage in a safe manner Parameters: Name Type Description photos Array.&lt;app.PhotoSource.SourcePhoto&gt; app.PhotoSource.SourcePhoto Array Source: photo_sources.js, line 140 Returns: non-null on error Type string process() â†’ {Promise.&lt;void&gt;} Process the photo source. This normally requires a https call and may fail for various reasons Source: photo_sources.js, line 102 Returns: void Type Promise.&lt;void&gt; use() â†’ {boolean} Determine if this source has been selected for display Source: photo_sources.js, line 93 Returns: true if selected Type boolean Type Definitions SourcePhoto A photo from a app.PhotoSource This is the photo information that is persisted. Type: Object Properties: Name Type Argument Description url string The url to the photo author string The photographer asp number The aspect ratio of the photo ex Object &lt;optional&gt; Additional information about the photo point string &lt;optional&gt; geolocation 'lat lon' Source: photo_sources.js, line 41 SourcePhotos The photos for a app.PhotoSource Type: Object Properties: Name Type Description type string type of app.PhotoSource photos Array.&lt;app.PhotoSource.SourcePhoto&gt; The photos Source: photo_sources.js, line 53 Ã— Search results Close "},"app.Reddit.html":{"id":"app.Reddit.html","title":"Namespace: Reddit","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: Reddit Reddit Interface to Reddit API Source: background/reddit.js, line 13 Members &lt;private, static, constant&gt; _KEY :string Reddit rest API authorization key Type: string Source: background/reddit.js, line 35 &lt;private, static, constant&gt; _MAX_PHOTOS :int Max photos to return Type: int Default Value: 100 Source: background/reddit.js, line 45 &lt;private, static, constant&gt; _MAX_SIZE :int Max size of photo to use Type: int Default Value: 3500 Source: background/reddit.js, line 65 &lt;private, static, constant&gt; _MIN_SIZE :int Min size of photo to use Type: int Default Value: 750 Source: background/reddit.js, line 55 &lt;private, static, constant&gt; _REDIRECT_URI :string Extension's redirect uri Type: string Source: background/reddit.js, line 25 &lt;private, static, constant&gt; _snoocore :function Expose reddit API Type: function Source: background/reddit.js, line 74 Methods &lt;private, static&gt; _getSize(title) â†’ {Object} Parse the size from the submission title. this is the old way reddit did it Parameters: Name Type Description title string submission title Source: background/reddit.js, line 93 Returns: Photo size Type Object &lt;private, static&gt; _processChildren(children) â†’ {Array.&lt;app.PhotoSource.SourcePhoto&gt;} Build the list of photos for one page of items Parameters: Name Type Description children Array Array of objects from reddit Source: background/reddit.js, line 111 Returns: Array of photos Type Array.&lt;app.PhotoSource.SourcePhoto&gt; &lt;static&gt; loadPhotos(subreddit) â†’ {Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt;} Retrieve the array of reddit photos Parameters: Name Type Description subreddit string name of photo subreddit Source: background/reddit.js, line 161 Returns: Array of photos Type Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt; Ã— Search results Close "},"app.ScreenSaver.html":{"id":"app.ScreenSaver.html","title":"Namespace: ScreenSaver","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: ScreenSaver ScreenSaver Display a screen saver Source: screensaver/screensaver.js, line 10 Members &lt;private, static, constant&gt; _CLOCK_ALARM :string repeating alarm for updating time label Type: string Default Value: updateTimeLabel Source: screensaver/screensaver.js, line 25 &lt;private, static, constant&gt; t :Object main auto-bind template Type: Object Source: screensaver/screensaver.js, line 38 &lt;static&gt; t.curIdx :int Index into t.photos Type: int Source: screensaver/screensaver.js, line 58 &lt;static&gt; t.photos :Array array of all the app.Photo to use for slide show Type: Array Source: screensaver/screensaver.js, line 51 &lt;static&gt; t.views :Array Array of app.SSView objects bound to the neon-animated-pages. The app.Photo property is an always changing subset of t.photos Type: Array Source: screensaver/screensaver.js, line 67 Methods &lt;static&gt; _findLoadedPhoto(idx) â†’ {int} Try to find a photo that has finished loading Parameters: Name Type Description idx int index into t.views Source: screensaver/screensaver.js, line 220 Returns: index into t.views, -1 if none are loaded Type int &lt;static&gt; _getNextPhoto(idx) â†’ {int} Get the next photo to display Parameters: Name Type Description idx int index into t.views Source: screensaver/screensaver.js, line 305 Returns: next - index into t.views to display, -1 if none are ready Type int &lt;private, static&gt; _markPhotoBad(idx) Mark a photo in t.photos as unusable Parameters: Name Type Description idx int index into t.views Source: screensaver/screensaver.js, line 197 &lt;static&gt; _onAlarm(alarm) Event: Listen for alarms Parameters: Name Type Description alarm Object chrome alarm Properties Name Type Description name string alarm type Source: screensaver/screensaver.js, line 403 &lt;private, static&gt; _onMessage(request [, sender] [, response]) â†’ {boolean} Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Argument Description request app.Msg.Message details for the message sender Object &lt;optional&gt; MessageSender object response function &lt;optional&gt; function to call once after processing Source: screensaver/screensaver.js, line 387 See: https://developer.chrome.com/extensions/runtime#event-onMessage Returns: true if asynchronous Type boolean &lt;static&gt; _processPhotoTransitions() Process settings related to between photo transitions Source: screensaver/screensaver.js, line 143 &lt;static&gt; _replaceAllPhotos() Replace the active photos with new photos from the master array Source: screensaver/screensaver.js, line 273 &lt;static&gt; _replacePhoto(idx, error) Add the next photo from the master array Parameters: Name Type Description idx int index into t.views error boolean true if the photo at idx didn't load Source: screensaver/screensaver.js, line 247 &lt;static&gt; _runShow() Called at fixed time intervals to cycle through the photos Potentially runs forever Source: screensaver/screensaver.js, line 334 &lt;private, static&gt; _setTime() Set the time label Source: screensaver/screensaver.js, line 182 &lt;static&gt; t._computeNoPhotos() â†’ {string} Computed property: No photos label Source: screensaver/screensaver.js, line 135 Returns: i18n label Type string &lt;static&gt; t._OnAniFinished() Event: Slide animation finished Source: screensaver/screensaver.js, line 115 Ã— Search results Close "},"app.SSControl.html":{"id":"app.SSControl.html","title":"Namespace: SSControl","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: SSControl SSControl Controller for the screen saver Source: background/ss_controller.js, line 13 Members &lt;private, static, constant&gt; _SS_URL :string Screensaver URL Type: string Default Value: /html/screensaver.html Source: background/ss_controller.js, line 28 Methods &lt;private, static&gt; _hasFullscreen(display) â†’ {Promise.&lt;boolean&gt;} Determine if there is a full screen chrome window running on a display Parameters: Name Type Description display Object a connected display Source: background/ss_controller.js, line 38 Returns: true if there is a full screen window on the display Type Promise.&lt;boolean&gt; &lt;private, static&gt; _isShowing() â†’ {Promise.&lt;boolean&gt;} Determine if the screen saver is currently showing Source: background/ss_controller.js, line 65 Returns: true if showing Type Promise.&lt;boolean&gt; &lt;private, static&gt; _onChromeMessage(request [, sender] [, response]) â†’ {boolean} Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Argument Description request app.Msg.Message details for the message sender Object &lt;optional&gt; MessageSender object response function &lt;optional&gt; function to call once after processing Source: background/ss_controller.js, line 178 See: https://developer.chrome.com/extensions/runtime#event-onMessage Returns: true if asynchronous Type boolean &lt;private, static&gt; _onIdleStateChanged(state) Event: Fired when the system changes to an active, idle or locked state. The event fires with &quot;locked&quot; if the screen is locked or the screensaver activates, &quot;idle&quot; if the system is unlocked and the user has not generated any input for a specified number of seconds, and &quot;active&quot; when the user generates input on an idle system. Parameters: Name Type Description state string current state of computer Source: background/ss_controller.js, line 148 See: https://developer.chrome.com/extensions/idle#event-onStateChanged &lt;private, static&gt; _open(display) Open a screen saver window on the given display Parameters: Name Type Description display Object a connected display Source: background/ss_controller.js, line 81 &lt;private, static&gt; _openOnAllDisplays() Open a screensaver on every display Source: background/ss_controller.js, line 122 &lt;static&gt; close() Close all the screen saver windows Source: background/ss_controller.js, line 211 &lt;static&gt; display(single) Display the screen saver(s) !Important: Always request screensaver through this call Parameters: Name Type Description single boolean if true, only show on one display Source: background/ss_controller.js, line 199 Ã— Search results Close "},"app.SSUtils.html":{"id":"app.SSUtils.html","title":"Namespace: SSUtils","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: SSUtils SSUtils Utility methods for a screensaver Source: screensaver/ss_utils.js, line 13 Members &lt;private, static, constant&gt; _MAX_PAGES :int Max number of animated pages Type: int Default Value: 20 Source: screensaver/ss_utils.js, line 26 Methods &lt;static&gt; close() Close ourselves Source: screensaver/ss_utils.js, line 165 &lt;static&gt; getTime() â†’ {string} Get the current time as a string Source: screensaver/ss_utils.js, line 151 Returns: time string suitable for display Type string &lt;static&gt; loadPhotos(t) Build the Array of app.Photo objects that will be displayed and the neon-animated-pages Parameters: Name Type Description t Object screensaver template Source: screensaver/ss_utils.js, line 94 &lt;static&gt; setNoPhotos(t) Set the state when no photos are available Parameters: Name Type Description t Object screensaver template Source: screensaver/ss_utils.js, line 34 &lt;static&gt; setupPhotoSizing(t) Process settings related to a photo's appearance Parameters: Name Type Description t Object screensaver template Source: screensaver/ss_utils.js, line 66 &lt;static&gt; setZoom() Set the window zoom factor to 1.0 Source: screensaver/ss_utils.js, line 46 Ã— Search results Close "},"app.SSView.html":{"id":"app.SSView.html","title":"Class: SSView","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Class: SSView SSView Screensaver zoom view and base class for other SSView classes new SSView(photo) Create a new SSView Parameters: Name Type Description photo app.Photo photo item Properties: Name Type Description image Element paper-image author Element label time Element label location Element Geo location model Object template item model Source: screensaver/views/ss_view.js, line 23 Methods &lt;static&gt; _showLocation() â†’ {boolean} Should we show the location, if available Source: screensaver/views/ss_view.js, line 68 Returns: true if we should show the location Type boolean &lt;static&gt; createView(photo, sizing) â†’ {app.SSView} Factory Method to create a new View Parameters: Name Type Description photo app.Photo photo item sizing int photo sizing type Source: screensaver/views/ss_view.js, line 46 Returns: a new SSView or subclass Type app.SSView &lt;static&gt; showTime() â†’ {boolean} Should we show the time Source: screensaver/views/ss_view.js, line 77 Returns: true if we should show the time Type boolean _hasAuthor() â†’ {boolean} Does a photo have an author label to show Source: screensaver/views/ss_view.js, line 85 Returns: true if we should show the author Type boolean _hasLocation() â†’ {boolean} Does a photo have a geolocation Source: screensaver/views/ss_view.js, line 93 Returns: true if geolocation point is non-null Type boolean _setLocation() Set the geolocation text Source: screensaver/views/ss_view.js, line 124 _setTimeStyle() Set the style for the time label Source: screensaver/views/ss_view.js, line 114 &lt;private&gt; _super500px() Add superscript to the label for 500px photos Source: screensaver/views/ss_view.js, line 101 getName() â†’ {string} Get the name of the photo in this view Source: screensaver/views/ss_view.js, line 178 Returns: name of photo Type string isError() â†’ {boolean} Determine if a photo failed to load (usually 404 error) Source: screensaver/views/ss_view.js, line 192 Returns: true if image load failed Type boolean isLoaded() â†’ {boolean} Determine if a photo has finished loading Source: screensaver/views/ss_view.js, line 200 Returns: true if image is loaded Type boolean render() Render the page for display - the default CSS is for our view subclasses override to determine the look of photo Source: screensaver/views/ss_view.js, line 186 setElements(image, author, time, location, model) Set the elements of the view Parameters: Name Type Description image Element paper-image, photo author Element div, photographer time Element div, current time location Element div, geolocation text model Object template item model Source: screensaver/views/ss_view.js, line 149 setPhoto(photo) Set the photo Parameters: Name Type Description photo app.Photo a photo to render Source: screensaver/views/ss_view.js, line 165 Ã— Search results Close "},"app.SSViewFrame.html":{"id":"app.SSViewFrame.html","title":"Class: SSViewFrame","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Class: SSViewFrame SSViewFrame Screensaver zoom view and base class for other SSView classes new SSViewFrame(photo) Create new SSViewFrame Parameters: Name Type Description photo app.Photo photo item Properties: Name Type Description image Element paper-image author Element label time Element label location Element Geo location model Object template item model Source: screensaver/views/ss_view_frame.js, line 24 Extends app.SSView Methods &lt;private, static&gt; _setLabelStyle(style, width, height, isLeft) Set style info for a label Parameters: Name Type Description style Object element.style object width int frame width height int frame height isLeft boolean if true align left, else right Source: screensaver/views/ss_view_frame.js, line 44 _hasAuthor() â†’ {boolean} Does a photo have an author label to show Inherited From: app.SSView#_hasAuthor Source: screensaver/views/ss_view.js, line 85 Returns: true if we should show the author Type boolean _hasLocation() â†’ {boolean} Does a photo have a geolocation Inherited From: app.SSView#_hasLocation Source: screensaver/views/ss_view.js, line 93 Returns: true if geolocation point is non-null Type boolean _setLocation() Set the geolocation text Inherited From: app.SSView#_setLocation Source: screensaver/views/ss_view.js, line 124 _setTimeStyle() Set the style for the time label Inherited From: app.SSView#_setTimeStyle Source: screensaver/views/ss_view.js, line 114 &lt;private&gt; _super500px() Add superscript to the label for 500px photos Inherited From: app.SSView#_super500px Source: screensaver/views/ss_view.js, line 101 getName() â†’ {string} Get the name of the photo in this view Inherited From: app.SSView#getName Source: screensaver/views/ss_view.js, line 178 Returns: name of photo Type string isError() â†’ {boolean} Determine if a photo failed to load (usually 404 error) Inherited From: app.SSView#isError Source: screensaver/views/ss_view.js, line 192 Returns: true if image load failed Type boolean isLoaded() â†’ {boolean} Determine if a photo has finished loading Inherited From: app.SSView#isLoaded Source: screensaver/views/ss_view.js, line 200 Returns: true if image is loaded Type boolean render() Render the page for display Overrides: app.SSView#render Source: screensaver/views/ss_view_frame.js, line 80 setElements(image, author, time, location, model) Set the elements of the view Parameters: Name Type Description image Element paper-image, photo author Element div, photographer time Element div, current time location Element div, geolocation text model Object template item model Inherited From: app.SSView#setElements Source: screensaver/views/ss_view.js, line 149 setPhoto(photo) Set the photo Parameters: Name Type Description photo app.Photo a photo to render Inherited From: app.SSView#setPhoto Source: screensaver/views/ss_view.js, line 165 Ã— Search results Close "},"app.SSViewFull.html":{"id":"app.SSViewFull.html","title":"Class: SSViewFull","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Class: SSViewFull SSViewFull Screensaver full view new SSViewFull(photo) Create new SSViewFull Parameters: Name Type Description photo app.Photo photo item Properties: Name Type Description image Element paper-image author Element label time Element label location Element Geo location model Object template item model Source: screensaver/views/ss_view_full.js, line 24 Extends app.SSView Methods _hasAuthor() â†’ {boolean} Does a photo have an author label to show Inherited From: app.SSView#_hasAuthor Source: screensaver/views/ss_view.js, line 85 Returns: true if we should show the author Type boolean _hasLocation() â†’ {boolean} Does a photo have a geolocation Inherited From: app.SSView#_hasLocation Source: screensaver/views/ss_view.js, line 93 Returns: true if geolocation point is non-null Type boolean _setLocation() Set the geolocation text Inherited From: app.SSView#_setLocation Source: screensaver/views/ss_view.js, line 124 _setTimeStyle() Set the style for the time label Inherited From: app.SSView#_setTimeStyle Source: screensaver/views/ss_view.js, line 114 &lt;private&gt; _super500px() Add superscript to the label for 500px photos Inherited From: app.SSView#_super500px Source: screensaver/views/ss_view.js, line 101 getName() â†’ {string} Get the name of the photo in this view Inherited From: app.SSView#getName Source: screensaver/views/ss_view.js, line 178 Returns: name of photo Type string isError() â†’ {boolean} Determine if a photo failed to load (usually 404 error) Inherited From: app.SSView#isError Source: screensaver/views/ss_view.js, line 192 Returns: true if image load failed Type boolean isLoaded() â†’ {boolean} Determine if a photo has finished loading Inherited From: app.SSView#isLoaded Source: screensaver/views/ss_view.js, line 200 Returns: true if image is loaded Type boolean render() Render the page for display Overrides: app.SSView#render Source: screensaver/views/ss_view_full.js, line 38 setElements(image, author, time, location, model) Set the elements of the view Parameters: Name Type Description image Element paper-image, photo author Element div, photographer time Element div, current time location Element div, geolocation text model Object template item model Inherited From: app.SSView#setElements Source: screensaver/views/ss_view.js, line 149 setPhoto(photo) Set the photo Parameters: Name Type Description photo app.Photo a photo to render Inherited From: app.SSView#setPhoto Source: screensaver/views/ss_view.js, line 165 Ã— Search results Close "},"app.SSViewLetterbox.html":{"id":"app.SSViewLetterbox.html","title":"Class: SSViewLetterbox","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Class: SSViewLetterbox SSViewLetterbox Screensaver letterbox view new SSViewLetterbox(photo) Create new SSView Parameters: Name Type Description photo app.Photo photo item Properties: Name Type Description image Element paper-image author Element label time Element label location Element Geo location model Object template item model Source: screensaver/views/ss_view_letterbox.js, line 33 Extends app.SSView Members &lt;private, static, constant&gt; _SCREEN_AR :number Aspect ratio of screen Type: number Source: screensaver/views/ss_view_letterbox.js, line 21 Methods _hasAuthor() â†’ {boolean} Does a photo have an author label to show Inherited From: app.SSView#_hasAuthor Source: screensaver/views/ss_view.js, line 85 Returns: true if we should show the author Type boolean _hasLocation() â†’ {boolean} Does a photo have a geolocation Inherited From: app.SSView#_hasLocation Source: screensaver/views/ss_view.js, line 93 Returns: true if geolocation point is non-null Type boolean _setLocation() Set the geolocation text Inherited From: app.SSView#_setLocation Source: screensaver/views/ss_view.js, line 124 _setTimeStyle() Set the style for the time label Inherited From: app.SSView#_setTimeStyle Source: screensaver/views/ss_view.js, line 114 &lt;private&gt; _super500px() Add superscript to the label for 500px photos Inherited From: app.SSView#_super500px Source: screensaver/views/ss_view.js, line 101 getName() â†’ {string} Get the name of the photo in this view Inherited From: app.SSView#getName Source: screensaver/views/ss_view.js, line 178 Returns: name of photo Type string isError() â†’ {boolean} Determine if a photo failed to load (usually 404 error) Inherited From: app.SSView#isError Source: screensaver/views/ss_view.js, line 192 Returns: true if image load failed Type boolean isLoaded() â†’ {boolean} Determine if a photo has finished loading Inherited From: app.SSView#isLoaded Source: screensaver/views/ss_view.js, line 200 Returns: true if image is loaded Type boolean render() Render the page for display Overrides: app.SSView#render Source: screensaver/views/ss_view_letterbox.js, line 47 setElements(image, author, time, location, model) Set the elements of the view Parameters: Name Type Description image Element paper-image, photo author Element div, photographer time Element div, current time location Element div, geolocation text model Object template item model Inherited From: app.SSView#setElements Source: screensaver/views/ss_view.js, line 149 setPhoto(photo) Set the photo Parameters: Name Type Description photo app.Photo a photo to render Inherited From: app.SSView#setPhoto Source: screensaver/views/ss_view.js, line 165 Ã— Search results Close "},"app.Storage.html":{"id":"app.Storage.html","title":"Namespace: Storage","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: Storage Storage Manage items in localStorage Source: storage.js, line 13 Methods &lt;static&gt; get(key) â†’ {JSON} Get a JSON parsed value from localStorage Parameters: Name Type Description key string key to get value for Source: storage.js, line 25 Returns: JSON object, null if key does not exist Type JSON &lt;static&gt; getBool(key) â†’ {boolean} Get boolean value from localStorage Parameters: Name Type Description key string key to get value for Source: storage.js, line 59 Returns: value as boolean, null if key does not exist Type boolean &lt;static&gt; getInt(key [, def]) â†’ {int} Get integer value from localStorage Parameters: Name Type Argument Default Description key string key to get value for def int &lt;optional&gt; &lt;nullable&gt; null optional value to return, if NaN Source: storage.js, line 41 Returns: value as integer, NaN on error Type int &lt;static&gt; safeSet(key, value [, keyBool]) â†’ {boolean} Save a value to localStorage only if there is enough room Parameters: Name Type Argument Description key string localStorage Key value Object value to save keyBool string &lt;optional&gt; key to a boolean value that is true if the primary key has non-empty value Source: storage.js, line 88 Returns: true if value was set successfully Type boolean &lt;static&gt; set(key [, value]) JSON stringify and save a value to localStorage Parameters: Name Type Argument Default Description key string key to set value for value Object &lt;optional&gt; &lt;nullable&gt; null new value, if null remove item Source: storage.js, line 69 Ã— Search results Close "},"app.Time.html":{"id":"app.Time.html","title":"Class: Time","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Class: Time Time Time Class new Time( [timeString]) Create a new Time Parameters: Name Type Argument Default Description timeString string &lt;optional&gt; &lt;nullable&gt; null in '00:00' format, if null use current Date Properties: Name Type Description _hr int 24 hour time _min int minutes Source: time.js, line 20 Members &lt;static&gt; MIN_IN_DAY Minutes in day Source: time.js, line 35 &lt;static&gt; MSEC_IN_DAY Milliseconds in day Source: time.js, line 43 Methods &lt;static&gt; getStringFull(timeString [, frmt]) â†’ {string} Get time as string suitable for display, including AM/PM if 12hr Parameters: Name Type Argument Default Description timeString string in '00:00' format frmt int &lt;optional&gt; &lt;nullable&gt; null optional format, overrides storage value Source: time.js, line 111 Returns: display string Type string &lt;static&gt; getStringShort() â†’ {string} Get current time suitable for display w/o AM/PM if 12hr Source: time.js, line 121 Returns: display string Type string &lt;static&gt; getTime(timeString) â†’ {int} Convert string to current time Parameters: Name Type Description timeString string in '00:00' format Source: time.js, line 52 Returns: time in milliSeconds from epoch Type int &lt;static&gt; getTimeDelta(timeString) â†’ {int} Calculate time delta from now on a 24hr basis Parameters: Name Type Description timeString string in '00:00' format Source: time.js, line 67 Returns: time delta in minutes Type int &lt;static&gt; is24Hr( [frmt]) â†’ {boolean} Determine if user wants 24 hr time Parameters: Name Type Argument Default Description frmt int &lt;optional&gt; &lt;nullable&gt; null optional format, overrides storage value Source: time.js, line 138 Returns: true for 24 hour time Type boolean &lt;static&gt; isInRange(start, stop) â†’ {boolean} Determine if current time is between start and stop, inclusive Parameters: Name Type Description start string in '00:00' format stop string in '00:00' format Source: time.js, line 84 Returns: true if in the given range Type boolean &lt;private&gt; _parse(timeString) Parse time string Parameters: Name Type Description timeString string in '00:00' format Source: time.js, line 160 toString( [frmt]) â†’ {string} Get string representation of Time Parameters: Name Type Argument Default Description frmt int &lt;optional&gt; &lt;nullable&gt; null optional format, overrides storage value Source: time.js, line 176 Returns: As string Type string Ã— Search results Close "},"app.Use500px.html":{"id":"app.Use500px.html","title":"Namespace: Use500px","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: Use500px Use500px Interface to 500px API Source: background/use500px.js, line 13 Members &lt;private, static, constant&gt; _CATS :Array Categories to use Make them an array to overcome 100 photo limit per call Type: Array Default Value: [&quot;Nature,City and Architecture&quot;,&quot;Landscapes,Animals&quot;,&quot;Macro,Still Life,Underwater&quot;] Source: background/use500px.js, line 55 &lt;private, static, constant&gt; _KEY :string API authorization key Type: string Source: background/use500px.js, line 35 &lt;private, static, constant&gt; _MAX_PHOTOS :int Max photos to return - 100 is API max Type: int Default Value: 90 Source: background/use500px.js, line 45 &lt;private, static, constant&gt; _URL_BASE :string 500px rest API Type: string Default Value: https://api.500px.com/v1/ Source: background/use500px.js, line 26 Methods &lt;private, static&gt; _doGet(url) â†’ {Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt;} Call API to get some photos Parameters: Name Type Description url string server url Source: background/use500px.js, line 68 Returns: Array of photos Type Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt; &lt;static&gt; loadPhotos(type) â†’ {Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt;} Retrieve the array of 500px photos Parameters: Name Type Description type string name of 500px gallery Source: background/use500px.js, line 99 Returns: Array of photos Type Promise.&lt;Array.&lt;app.PhotoSource.SourcePhoto&gt;&gt; Ã— Search results Close "},"app.Utils.html":{"id":"app.Utils.html","title":"Namespace: Utils","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Namespace: Utils Utils Utility methods Source: utils.js, line 13 Methods &lt;static&gt; getChromeVersion() â†’ {int} Get the Chrome version Source: utils.js, line 43 See: http://stackoverflow.com/a/4900484/4468645 Returns: Chrome major version Type int &lt;static&gt; getExtensionName() â†’ {string} Get the extension's name Source: utils.js, line 23 Returns: Extension name Type string &lt;static&gt; getFullChromeVersion() â†’ {string} Get the full Chrome version Source: utils.js, line 54 See: https://goo.gl/2ITMNO Returns: Chrome version Type string &lt;static&gt; getIdleSeconds() â†’ {int} Get the idle time in seconds Source: background/data.js, line 346 Returns: idle time in seconds Type int &lt;static&gt; getLocale() â†’ {string} Get the current locale Source: utils.js, line 75 Returns: current locale e.g. en_US Type string &lt;static&gt; getRandomInt(min, max) â†’ {int} Returns a random integer between min and max inclusive Parameters: Name Type Description min int min value max int max value Source: utils.js, line 105 Returns: random int Type int &lt;static&gt; getVersion() â†’ {string} Get the Extension version Source: utils.js, line 32 Returns: Extension version Type string &lt;static&gt; isWhiteSpace(str) â†’ {boolean} Determine if a String is null or whitespace only Parameters: Name Type Argument Description str string &lt;nullable&gt; string to check Source: utils.js, line 85 Returns: true is str is whitespace (or null) Type boolean &lt;static&gt; isWin() â†’ {boolean} true if we are MS windows Source: utils.js, line 94 Returns: true if MS windows Type boolean &lt;static&gt; localize(messageName) â†’ {string} Get the i18n string Parameters: Name Type Description messageName string key in messages.json Source: utils.js, line 66 Returns: internationalized string Type string &lt;static&gt; shuffleArray(array) Randomly sort an Array in place Fisher-Yates shuffle algorithm. Parameters: Name Type Description array Array Array to sort Source: utils.js, line 115 Ã— Search results Close "},"ExceptionHandler.html":{"id":"ExceptionHandler.html","title":"Class: ExceptionHandler","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.ChromeCastapp.Dataapp.Flickrapp.GAapp.Geoapp.GooglePhotosapp.Httpapp.JSONUtilsapp.Msgapp.Optionsapp.Permissionsapp.Redditapp.ScreenSaverapp.SSControlapp.SSUtilsapp.Storageapp.Use500pxapp.Utils Classes app.Photoapp.PhotoSourceapp.SSViewapp.SSViewFrameapp.SSViewFullapp.SSViewLetterboxapp.TimeExceptionHandler Global PICASA Class: ExceptionHandler ExceptionHandler new ExceptionHandler() Log Exceptions with analytics. Include: new ExceptionHandler() at top of every js file Source: exception_handler.js, line 21 Ã— Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
